<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Networks: Networks - Applications</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav l2d"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="l2d" src="assets/images/l2d-logo.svg"></div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/03-networks_3.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav l2d" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="l2d" src="assets/images/l2d-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Networks
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Networks
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item">
          <a class="external-link nav-link" href="https://learntodiscover.github.io/L2D-Handbook/" target="_blank" rel="noopener noreferrer">L2D Handbook</a>
        </li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Networks
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 67%" class="percentage">
    67%
  </div>
  <div class="progress l2d">
    <div class="progress-bar l2d" role="progressbar" style="width: 67%" aria-valuenow="67" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar" style="display: flex">
        <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle sticky-top" data-collapse="Collapse " data-episodes="Episodes ">
                <i class="search-icon" data-feather="x" role="img"></i>
            </button>
            <div class="sidebar-inner sticky-top">
                <div class="row mobile-row">
                    <div class="col">
                        <div class="sidenav-view-selector">
                            <div class="accordion accordion-flush" id="accordionFlush9">
                                <div class="accordion-item">
 
                                    <h2 class="accordion-header" id="flush-headingNine">
                                        <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                                            <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i>
                                            Learner View
                                        </button>
                                    </h2>
                                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                                        <div class="accordion-body">
                                            <a href="instructor/03-networks_3.html">Instructor View</a>
                                        </div>
                                    </div>
                                </div>
                                <!--/div.accordion-item-->
                            </div>
                            <!--/div.accordion-flush-->
                        </div>
                        <!--div.sidenav-view-selector -->
                    </div>
                    <!--/div.col -->
                    
                    <hr></div>
                <!--/div.mobile-row -->

                <div class="accordion accordion-flush" id="accordionFlush11">
                    <div class="accordion-item">
                        <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                            <h2 class="accordion-header chapters" id="flush-headingEleven">
                                EPISODES
                            </h2>
                        </button>
                        <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">
                            <div class="accordion-body"><div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-networks_1.html">1. Networks - Introduction</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-networks_2.html">2. Networks - Quantification</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3. Networks - Applications
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#importing-data-into-networkx">Importing data into NetworkX</a>
<ul><li><a href="#csv-format"><strong>CSV Format</strong></a></li>
<li><a href="#networks-repository-list-of-edges"><strong>Networks Repository: List of Edges</strong></a></li>
<li><a href="#json-format"><strong>JSON Format</strong></a></li></ul></li>
<li><a href="#networkx-troubleshooting">NetworkX troubleshooting</a>
<ul><li><a href="#filenotfounderror"><strong>FileNotFoundError</strong></a></li>
<li><a href="#keyerror"><strong>KeyError</strong></a></li>
<li><a href="#graph-is-not-bipartite"><strong>Graph is not bipartite</strong></a></li></ul></li>
<li><a href="#example-full-c.-elegans-neural-network">Example: Full <em>C. elegans</em> Neural Network</a></li>
<li><a href="#example-microbiome-network">Example: Microbiome network</a>
<ul><li><a href="#functional-networks"><strong>Functional Networks</strong></a></li></ul></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->
</div>
                        </div>
                    </div>
                     
                    <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="flush-headingTwelve">
                                <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                                    RESOURCES
                                </button>
                            </h2>
                            <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                                <div class="accordion-body">
                                    <ul><li>
                                            <a href="key-points.html">Key Points</a>
                                        </li>
                                        <li>
                                            <a href="profiles.html">Learner Profiles</a>
                                        </li>
                                         
                                    </ul></div>
                            </div>
                        </div>
                    </div>
                    <hr class="half-width resources"><a href="aio.html">See all in one page</a>
                    
                    <br><a href="aio.pdf">See all in one page [PDF]</a> 

                    <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
                        
                    </div>
                </div>
                <!-- /div.accordion -->
            </div>
            <!-- /div.sidebar-inner -->
        </nav></div>
    <!-- /div.sidebar -->
</div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="02-networks_2.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="02-networks_2.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Networks -
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Networks - Applications</h1>
        <p>Last updated on 2024-05-22 |
        
        <a href="https://github.com/LearnToDiscover/Networks.git/edit/main/episodes/03-networks_3.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

            <p><a href="03-networks_3.pdf"><strong>Download Chapter PDF</strong></a></p>

        

<p><a href="03-networks_3.ipynb"><strong>Download Chapter notebook
(ipynb)</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-5">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What ways are there to import data into NetworkX?</li>
<li>What are the common file import error?</li>
<li>How to troubleshoot the import errors?</li>
</ul></div>
</div>
</div>
<div class="col-md-7">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Reviewing data import</li>
<li>Understanding troubleshooting of common errors in data import</li>
<li>Handling a bipartite network</li>
<li>Applying network concepts to real-world datasets</li>
</ul></div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<ul><li><a href="01-networks_1.html">Networks - Part 1</a></li>
<li><a href="02-networks_2.html">Networks - Part 2</a></li>
</ul></div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> mean, fill_diagonal</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> randint</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, show</span></code></pre>
</div>
<section id="importing-data-into-networkx"><h2 class="section-heading">Importing data into NetworkX<a class="anchor" aria-label="anchor" href="#importing-data-into-networkx"></a>
</h2>
<hr class="half-width"><p style="text-align: justify;">
In the previous lessons we have looked at the basics of NetworkX,
created some networks, analysed various network properties, and
practised these techniques with the pre-prepared <em>C. elegans</em>
dataset. If you want to use NetworkX with data of your own, you’ll need
to import your data in a compatible way. Specifically, you need to be
able to import data from different original data formats.
</p>
<div class="section level3">
<h3 id="csv-format"><strong>CSV Format</strong><a class="anchor" aria-label="anchor" href="#csv-format"></a></h3>
<p><code>.csv</code> indicates a very common file format, <a href="https://en.wikipedia.org/wiki/Comma-separated_values" class="external-link">comma
separated values</a>. We used it in the previous lesson to import the
<em>C. elegans</em> neuronal network.</p>
<p style="text-align: justify;">
The network data ‘celegans131matrix_50.csv’ is simply a large adjacency
matrix of 0s and 1s, with no further information. The
‘celegans131labels_50.csv’ file contains the list of neuron names, which
we used to label the nodes. We’ll have a look in more detail at how this
import works. We use Pandas functions as a simple way to import a CSV
file. (There are, of course, other ways.)
</p>
<p>Here is the import of the data for the first 50 neurons.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>neurons<span class="op">=</span>read_csv(<span class="st">'data/celegans131matrix_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>, dtype <span class="op">=</span> <span class="st">"int"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>neurons<span class="op">=</span>neurons.to_numpy()</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(neurons))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">50</span></span></code></pre>
</div>
<p style="text-align: justify;">
We import the CSV network file as before. We specify with a keyword
argument that there is no header, otherwise the first line in the file
will be assumed to be a header and not parsed (handled) in the same way
as the rest of the data. We also specify that the adjacency matrix is of
data type <code>int</code>. (This does not necessarily have to be the
case, see the Microbiome network below.) We then convert the
<code>neurons</code> dataframe to a Numpy array. The
<code>neuron_Names</code> can be imported in a similar way. They will
need to be converted from a dataframe to a dictionary:
</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>neuron_Names <span class="op">=</span> read_csv(<span class="st">'data/celegans131labels_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>neuronNames <span class="op">=</span> neuron_Names.to_dict()</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>neuronLabels <span class="op">=</span> neuronNames[<span class="dv">0</span>]</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="bu">print</span>(neuronLabels)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{0: 'ADFL', 1: 'ADFR', 2: 'ADLL', 3: 'ADLR', 4: 'AFDL', 5: 'AFDR', 6: 'AIAL', 7: 'AIAR', 8: 'AIBR', 9: 'AINL', 10: 'AINR', 11: 'AIZL', 12: 'AIZR', 13: 'ALA', 14: 'ASEL', 15: 'ASER', 16: 'ASGL', 17: 'ASGR', 18: 'ASHL', 19: 'ASHR', 20: 'ASIL', 21: 'ASIR', 22: 'ASJL', 23: 'ASJR', 24: 'ASKL', 25: 'ASKR', 26: 'AUAL', 27: 'AUAR', 28: 'AVAL', 29: 'AVAR', 30: 'AVBL', 31: 'AVBR', 32: 'AVDL', 33: 'AVDR', 34: 'AVEL', 35: 'AVER', 36: 'AVHL', 37: 'AVHR', 38: 'AVJL', 39: 'AVJR', 40: 'AVL', 41: 'AWAL', 42: 'AWAR', 43: 'AWBL', 44: 'AWBR', 45: 'AWCL', 46: 'AWCR', 47: 'BAGL', 48: 'BAGR', 49: 'CEPDL'}</code></pre>
</div>
<p style="text-align: justify;">
Dictionaries associate keys with values. You may remember we previously
created a dictionary to assign labels to nodes. Here we convert the
<code>neuron_Names</code> dataframe into a dictionary: the neuron (node)
indices are the keys and the corresponding neuron (node) names are the
values. As the function <code>to_dict</code> wraps the dictionary within
a dictionary, we obtain the plain labels dictionary by referring to
index ‘0’.
</p>
<p>Now we can create a graph, specify a layout, and plot the
network.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>neuronGraph <span class="op">=</span> nx.from_numpy_matrix(neurons)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>neuronLayout <span class="op">=</span> nx.random_layout(neuronGraph, seed<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>nx.draw_networkx(neuronGraph, neuronLayout,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>        labels <span class="op">=</span> neuronLabels)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
In this particular case, we also have other metadata that can be used
for visualisation and analysis. In our case, we have the file
‘celegans131positions_50.csv’ - which contains information on how the
nodes relate to each other in 2-D space. We can include this information
to replace the layout.
</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>neuronPos <span class="op">=</span> read_csv(<span class="st">'data/celegans131positions_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>neuronPositions <span class="op">=</span> neuronPos.values</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>nx.draw(neuronGraph, neuronPositions,</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>        labels <span class="op">=</span> neuronLabels)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-5-3.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The two BAG nodes to the right of the display are the (right and
left) <a href="https://www.wormatlas.org/neurons/Individual%20Neurons/BAGframeset.html" class="external-link">sensory
neurons used to monitor oxygen and carbon dioxide</a>.</p>
<div id="do-it-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself"></a>
</h3>
<div class="callout-content">
<p>Find the node indices of the sensory neurons named ‘BAGL’ and
‘BAGR’.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="cf">for</span> ind, name <span class="kw">in</span> <span class="bu">enumerate</span>(neuronLabels.values()):</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'BAG'</span> <span class="kw">in</span> name:</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>        <span class="bu">print</span>(ind, neuronLabels[ind])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>47 BAGL
48 BAGR</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="networks-repository-list-of-edges"><strong>Networks Repository: List of Edges</strong><a class="anchor" aria-label="anchor" href="#networks-repository-list-of-edges"></a></h3>
<p style="text-align: justify;">
Network files in the <a href="http://networkrepository.com/index.php" class="external-link">Network Repository</a> are
sourced from publications and provided in the ‘.edges’ format. These are
plain text files. Let’s have a look at the network of a mouse visual
cortex. You can find this at <a href="http://networkrepository.com/bn-mouse-visual-cortex-1.php" class="external-link">MOUSE-VISUAL-CORTEX-1</a>.
You can either download the zip file from the database or use the file
provided for this Lesson.
</p>
<p style="text-align: justify;">
Place the file ‘bn-mouse_visual-cortex_1.edges’ in your working
directory. It can be helpful to first open it in any text-editor to see
what the data look like. In this case, it is a list of two numbers per
row, separated by a space. This is the list of (directed) edges. The
first number indicating ‘from’, the second ‘to’. Nodes are not given
explicitly but will be inferred from the indices.
</p>
<p>Being a list of edges, we can import it into NetworkX as an
<em>edgelist</em>, specifying that the nodes are given as integers. The
result is a standard graph object which we can plot using
<code>draw</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>MouseCortex <span class="op">=</span> nx.read_edgelist(<span class="st">"data/bn-mouse_visual-cortex_1.edges"</span>, nodetype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>MouseCortexLayout <span class="op">=</span> nx.random_layout(MouseCortex, seed<span class="op">=</span><span class="dv">111</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>nx.draw(MouseCortex, MouseCortexLayout,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'r'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-7-5.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>To interpret the network, you can check it against the source, <a href="http://networkrepository.com/bn-mouse-visual-cortex-1.php" class="external-link">MOUSE-VISUAL-CORTEX-1</a>.</p>
<div id="do-it-yourself-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-1" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-1"></a>
</h3>
<div class="callout-content">
<p>Network Repository provides some summary data on all their networks.
Obtain the (i) number of nodes, (ii) number of edges, and (iii) average
clustering coefficient and compare it to the data in <a href="https://networkrepository.com/bn-mouse-visual-cortex-1.php" class="external-link">their
network summary</a>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of nodes:'</span>, <span class="bu">len</span>(MouseCortex))</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of edges:'</span>, <span class="bu">len</span>(MouseCortex.edges))</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Average clustering coefficient:'</span>, mean(<span class="bu">list</span>(nx.clustering(MouseCortex).values())))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Number of nodes: 29

Number of edges: 44

Average clustering coefficient: 0.04942528735632184</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="json-format"><strong>JSON Format</strong><a class="anchor" aria-label="anchor" href="#json-format"></a></h3>
<p style="text-align: justify;">
<a href="https://en.wikipedia.org/wiki/JSON" class="external-link">JSON (JavaScript Object
Notation)</a> is an open standard file format which is language
independent and widely used. Here is an example code to import and
display the network that contains <a href="http://konect.cc/networks/moreno_lesmis/" class="external-link">co-occurances of
characters in Victor Hugo’s novel ‘Les Misérables’</a>.
</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'data/miserables.json'</span>, <span class="st">'r'</span>) <span class="im">as</span> myfile:</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    data<span class="op">=</span>myfile.read()</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>miserables <span class="op">=</span> json.loads(data)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>miserablesNetwork <span class="op">=</span> nx.json_graph.node_link_graph(miserables)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>miserablesNetworkLayout <span class="op">=</span> nx.circular_layout(miserablesNetwork)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>nx.draw(miserablesNetwork, miserablesNetworkLayout,</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-9-7.png" width="1152" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>As you can see, the ‘data’ variable contains the character names as
node names.</p>
<p>If you are curious, open the file with a text editor and check the
entries.</p>
<p>E.g. our file starts like this:</p>
<pre><code>{

  "nodes": [

    {"id": "Myriel", "group": 1},</code></pre>
<p style="text-align: justify;">
As you can see, the style with curly brackets and colons immediately
suggests the use of associative arrays (dictionary) once the data are
within Python. The function <code>node_link_graph</code> provides an
interface to handle the data as a NetworkX graph.
</p>
<p style="text-align: justify;">
There are many other files formats that contain network data. For a list
of NetworkX functions that allow import from and export to other file
formats, see <a href="http://localhost:8888/lab/tree/Dropbox/Lessons_NetworkX" class="external-link">Reading
and writing graphs</a>.
</p>
</div>
</section><section id="networkx-troubleshooting"><h2 class="section-heading">NetworkX troubleshooting<a class="anchor" aria-label="anchor" href="#networkx-troubleshooting"></a>
</h2>
<hr class="half-width"><p>There are many errors that may occur in the context of dealing with
network data. We exemplify some common problems, to help find out how to
diagnose and solve them.</p>
<div class="section level3">
<h3 id="filenotfounderror"><strong>FileNotFoundError</strong><a class="anchor" aria-label="anchor" href="#filenotfounderror"></a></h3>
<p>Here we try to import a CSV file which contains an adjacency matrix.
We have checked that the file is present in the working directory.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>neurons <span class="op">=</span> read_csv(<span class="st">'data/celegans131mtrix_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="st">"float64"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>FileNotFoundError: [Errno 2] No such file or directory: 'data/celegans131mtrix_50.csv'</code></pre>
</div>
<div id="do-it-yourself-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-2" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-2"></a>
</h3>
<div class="callout-content">
<p>What has gone wrong, and what is the solution?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>You’ll see this error if something has gone wrong in the way you’ve
instructed Python to find your file. This may be that you’ve mis-typed
the file name, or the file isn’t in your working directory. Here, the
file is present in the working directory, but there’s a typo in the file
name.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>neurons <span class="op">=</span> read_csv(<span class="st">'data/celegans131matrix_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="st">'int'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="keyerror"><strong>KeyError</strong><a class="anchor" aria-label="anchor" href="#keyerror"></a></h3>
<p>Here we generate a random adjacency matrix, specify how it should be
plotted, and try to visualise it.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>rm <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>thisgraph <span class="op">=</span> nx.from_numpy_matrix(rm)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>thisgraphLayout <span class="op">=</span> nx.spiral_layout(thisgraph)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>thisgraphLabels <span class="op">=</span> {</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'D'</span>,</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'E'</span>,</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'F'</span>,</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>}</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>nx.draw(thisgraph, thisgraphLayout,</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>        labels<span class="op">=</span>thisgraphLabels)</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">KeyError</span><span class="op">:</span> <span class="fl">5</span></span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-12-9.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="do-it-yourself-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-3" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-3"></a>
</h3>
<div class="callout-content">
<p>Why does the call of <code>draw</code> throw an error, and what is
the solution?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>If you look at the error message, it first flags <strong>5:
‘F’,</strong>, and ends with an error about labels. We’ve included too
many node labels: 6 labels for five nodes. This is easily corrected by
taking one label out.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>rm <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>thisgraph <span class="op">=</span> nx.from_numpy_matrix(rm)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>thisgraphLayout <span class="op">=</span> nx.spiral_layout(thisgraph)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>thisgraphLabels <span class="op">=</span> {</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'D'</span>,</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'E'</span>,</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>}</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>nx.draw(thisgraph, thisgraphLayout,</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'tomato'</span>,</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>        labels<span class="op">=</span>thisgraphLabels)</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-13-11.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="graph-is-not-bipartite"><strong>Graph is not bipartite</strong><a class="anchor" aria-label="anchor" href="#graph-is-not-bipartite"></a></h3>
<p>Here we generate a bipartite graph and try to plot it.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>thisBipartite <span class="op">=</span> nx.Graph()</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co"># Add nodes with the node attribute "bipartite"</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>thisBipartite.add_nodes_from([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span>], bipartite<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>thisBipartite.add_nodes_from([<span class="st">'m'</span>, <span class="st">'n'</span>, <span class="st">'o'</span>, <span class="st">'p'</span>, <span class="st">'q'</span>, <span class="st">'r'</span>], bipartite<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co"># Add edges only between nodes of opposite node sets</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>thisBipartite.add_edges_from([(<span class="st">'a'</span>, <span class="st">'m'</span>), (<span class="st">'a'</span>, <span class="st">'n'</span>),</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>                              (<span class="st">'b'</span>, <span class="st">'n'</span>), (<span class="st">'b'</span>, <span class="st">'o'</span>),</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>                              (<span class="st">'c'</span>, <span class="st">'o'</span>), (<span class="st">'d'</span>, <span class="st">'m'</span>),</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>                              (<span class="st">'a'</span>, <span class="st">'p'</span>), (<span class="st">'a'</span>, <span class="st">'d'</span>),</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>                              (<span class="st">'f'</span>, <span class="st">'p'</span>), (<span class="st">'d'</span>, <span class="st">'r'</span>),</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>                              (<span class="st">'a'</span>, <span class="st">'q'</span>), (<span class="st">'e'</span>, <span class="st">'n'</span>)])</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>nx.is_connected(thisBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>basegroup <span class="op">=</span> nx.bipartite.sets(thisBipartite)[<span class="dv">0</span>]</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>bipartiteLayout <span class="op">=</span> nx.bipartite_layout(thisBipartite, basegroup)</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>nx.draw(thisBipartite, bipartiteLayout,</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">2000</span>,</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>networkx.exception.NetworkXError: Graph is not bipartite.
NameError: name 'basegroup' is not defined
NameError: name 'bipartiteLayout' is not defined</code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-16-13.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="do-it-yourself-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-4" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-4"></a>
</h3>
<div class="callout-content">
<p>Why did this happen, what check can you do to avoid the problem, and
how do you debug it?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<p>In this instance, the error message is very clear: you can’t plot a
graph with a bipartite layout if the graph isn’t bipartite. This would
have also been evident if I hadn’t just checked that the graph was
connected, but also that it was bipartite.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>nx.bipartite.is_bipartite(thisBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">False</span></span></code></pre>
</div>
<p>There is one edge connecting two nodes within one group. If we either
remove that edge, or change one of the nodes to the other group, it will
be bipartite.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>thisBipartite <span class="op">=</span> nx.Graph()</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="co"># Add nodes with the node attribute "bipartite"</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>thisBipartite.add_nodes_from([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span>], bipartite<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>thisBipartite.add_nodes_from([<span class="st">'m'</span>, <span class="st">'n'</span>, <span class="st">'o'</span>, <span class="st">'p'</span>, <span class="st">'q'</span>, <span class="st">'r'</span>], bipartite<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="co"># Add edges only between nodes of opposite node sets</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>thisBipartite.add_edges_from([(<span class="st">'a'</span>, <span class="st">'m'</span>), (<span class="st">'a'</span>, <span class="st">'n'</span>),</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>                              (<span class="st">'b'</span>, <span class="st">'n'</span>), (<span class="st">'b'</span>, <span class="st">'o'</span>),</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>                              (<span class="st">'c'</span>, <span class="st">'o'</span>), (<span class="st">'d'</span>, <span class="st">'m'</span>),</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>                              (<span class="st">'a'</span>, <span class="st">'p'</span>), (<span class="st">'a'</span>, <span class="st">'n'</span>),</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>                              (<span class="st">'f'</span>, <span class="st">'p'</span>), (<span class="st">'d'</span>, <span class="st">'r'</span>),</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>                              (<span class="st">'a'</span>, <span class="st">'q'</span>), (<span class="st">'e'</span>, <span class="st">'n'</span>)])</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>nx.bipartite.is_bipartite(thisBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>basegroup <span class="op">=</span> nx.bipartite.sets(thisBipartite)[<span class="dv">0</span>]</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>bipartiteLayout <span class="op">=</span> nx.bipartite_layout(thisBipartite, basegroup)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>fig <span class="op">=</span> nx.draw(thisBipartite, bipartiteLayout,</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>              node_size<span class="op">=</span><span class="dv">2000</span>,</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>              node_color<span class="op">=</span><span class="st">'tomato'</span>,</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>              node_shape<span class="op">=</span><span class="st">'h'</span>,</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>              with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a></span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-20-15.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</div>
</section><section id="example-full-c.-elegans-neural-network"><h2 class="section-heading">Example: Full <em>C. elegans</em> Neural Network<a class="anchor" aria-label="anchor" href="#example-full-c.-elegans-neural-network"></a>
</h2>
<hr class="half-width"><p>In the final part, we look at two publicly available networks that
are of biomedical interest.</p>
<p style="text-align: justify;">
In this first example we return to data about the neuronal connections
in <em>C. elegans</em>. This time we are using the full 277 neuron
dataset, which includes 131 frontal neurons. For the original version of
the data, go to the (<a href="https://www.dynamic-connectome.org/" class="external-link">Dynamic Connectome</a>)
website and select the Resources tab.
</p>
<p style="text-align: justify;">
The data in the <span class="math inline">\(277 \times 277\)</span>
network matrix in the celegans277.zip file contain the connections
between the 131 neurons in the frontal network, and 146 in the remainder
or the network. If the connections <em>within</em> each of these groups
are severed, and the only remaining edges are between the two groups,
this takes the form of a <em>bipartite graph</em>.
</p>
<p style="text-align: justify;">
We have made available this modified version of the 277 neuron matrix,
with no edges within the 131 or the 146 neuron group, see file
‘celegans277matrix_bipartite.csv’. Note that bipartite networks do not
work in NetworkX if any of the nodes are not connected. Also available
for download is a list of neuron labels and spatial positions, files
‘celegans277labels.csv’ and ‘celegans277positions.csv’.
</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>neurons <span class="op">=</span> read_csv(<span class="st">'data/celegans277matrix_bipartite.csv'</span>, header<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="st">"int"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>neuronNames <span class="op">=</span> read_csv(<span class="st">'data/celegans277labels.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>neurons<span class="op">=</span> neurons.to_numpy()</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>neuronNames<span class="op">=</span> neuronNames.to_dict()</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>myBipartiteLabels <span class="op">=</span> neuronNames[<span class="dv">0</span>]</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>myBipartite <span class="op">=</span> nx.from_numpy_matrix(neurons)</span></code></pre>
</div>
<p style="text-align: justify;">
Here we import the bipartite module from NetworkX, and then import the
bipartite 277 neuron adjacency matrix and list of neuron names, with the
same method as previously. Next, we use the bipartite convention in
NetworkX to designate which nodes are in the <span class="math inline">\(0\)</span> group, and which are in the <span class="math inline">\(1\)</span> group. There are several ways to make a
graph bipartite, here this is done by listing the node numbers of the
146 neurons and adding the attribute <span class="math inline">\('bipartite' = 0\)</span>, and listing the
node numbers of the 131 neurons and adding the attribute <span class="math inline">\('bipartite' = 1\)</span>.
</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>myBipartite.add_nodes_from([</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="dv">0</span>,   <span class="dv">1</span>,   <span class="dv">2</span>,   <span class="dv">3</span>,  <span class="dv">13</span>,  <span class="dv">14</span>,  <span class="dv">17</span>,  <span class="dv">21</span>,  <span class="dv">22</span>,  <span class="dv">23</span>,  <span class="dv">24</span>,  <span class="dv">25</span>,</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a> <span class="dv">26</span>,  <span class="dv">27</span>,  <span class="dv">28</span>,  <span class="dv">29</span>,  <span class="dv">30</span>,  <span class="dv">31</span>,  <span class="dv">32</span>,  <span class="dv">33</span>,  <span class="dv">34</span>,  <span class="dv">35</span>,  <span class="dv">36</span>,  <span class="dv">59</span>,</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a> <span class="dv">60</span>,  <span class="dv">61</span>,  <span class="dv">66</span>,  <span class="dv">67</span>,  <span class="dv">69</span>,  <span class="dv">78</span>,  <span class="dv">79</span>,  <span class="dv">84</span>,  <span class="dv">85</span>,  <span class="dv">86</span>,  <span class="dv">87</span>,  <span class="dv">88</span>,</span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a> <span class="dv">89</span>,  <span class="dv">90</span>,  <span class="dv">91</span>,  <span class="dv">92</span>,  <span class="dv">93</span>,  <span class="dv">94</span>,  <span class="dv">95</span>,  <span class="dv">96</span>,  <span class="dv">97</span>,  <span class="dv">98</span>,  <span class="dv">99</span>, <span class="dv">100</span>,</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">104</span>, <span class="dv">105</span>, <span class="dv">106</span>, <span class="dv">107</span>, <span class="dv">108</span>, <span class="dv">109</span>, <span class="dv">110</span>, <span class="dv">111</span>, <span class="dv">112</span>,</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a><span class="dv">125</span>, <span class="dv">126</span>, <span class="dv">133</span>, <span class="dv">134</span>, <span class="dv">135</span>, <span class="dv">136</span>, <span class="dv">137</span>, <span class="dv">138</span>, <span class="dv">139</span>, <span class="dv">140</span>, <span class="dv">141</span>, <span class="dv">142</span>,</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a><span class="dv">143</span>, <span class="dv">144</span>, <span class="dv">145</span>, <span class="dv">146</span>, <span class="dv">147</span>, <span class="dv">148</span>, <span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">151</span>, <span class="dv">152</span>, <span class="dv">153</span>, <span class="dv">154</span>,</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a><span class="dv">155</span>, <span class="dv">156</span>, <span class="dv">157</span>, <span class="dv">158</span>, <span class="dv">159</span>, <span class="dv">160</span>, <span class="dv">161</span>, <span class="dv">162</span>, <span class="dv">170</span>, <span class="dv">171</span>, <span class="dv">172</span>, <span class="dv">173</span>,</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a><span class="dv">180</span>, <span class="dv">195</span>, <span class="dv">196</span>, <span class="dv">203</span>, <span class="dv">204</span>, <span class="dv">205</span>, <span class="dv">206</span>, <span class="dv">207</span>, <span class="dv">235</span>, <span class="dv">236</span>, <span class="dv">237</span>, <span class="dv">238</span>,</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a><span class="dv">239</span>, <span class="dv">240</span>, <span class="dv">241</span>, <span class="dv">242</span>, <span class="dv">243</span>, <span class="dv">244</span>, <span class="dv">245</span>, <span class="dv">246</span>, <span class="dv">247</span>, <span class="dv">248</span>, <span class="dv">249</span>, <span class="dv">250</span>,</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a><span class="dv">251</span>, <span class="dv">252</span>, <span class="dv">253</span>, <span class="dv">254</span>, <span class="dv">255</span>, <span class="dv">256</span>, <span class="dv">257</span>, <span class="dv">258</span>, <span class="dv">259</span>, <span class="dv">260</span>, <span class="dv">261</span>, <span class="dv">262</span>,</span>
<span id="cb33-13"><a href="#cb33-13" tabindex="-1"></a><span class="dv">263</span>, <span class="dv">264</span>, <span class="dv">265</span>, <span class="dv">266</span>, <span class="dv">267</span>, <span class="dv">268</span>, <span class="dv">269</span>, <span class="dv">270</span>, <span class="dv">271</span>, <span class="dv">272</span>, <span class="dv">273</span>, <span class="dv">274</span>,</span>
<span id="cb33-14"><a href="#cb33-14" tabindex="-1"></a><span class="dv">275</span>, <span class="dv">276</span>], bipartite<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb33-15"><a href="#cb33-15" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" tabindex="-1"></a>myBipartite.add_nodes_from([</span>
<span id="cb33-17"><a href="#cb33-17" tabindex="-1"></a>  <span class="dv">4</span>,   <span class="dv">5</span>,   <span class="dv">6</span>,   <span class="dv">7</span>,   <span class="dv">8</span>,   <span class="dv">9</span>,  <span class="dv">10</span>,  <span class="dv">11</span>,  <span class="dv">12</span>,  <span class="dv">15</span>,  <span class="dv">16</span>,</span>
<span id="cb33-18"><a href="#cb33-18" tabindex="-1"></a> <span class="dv">18</span>,  <span class="dv">19</span>,  <span class="dv">20</span>,  <span class="dv">37</span>,  <span class="dv">38</span>,  <span class="dv">39</span>,  <span class="dv">40</span>,  <span class="dv">41</span>,  <span class="dv">42</span>,  <span class="dv">43</span>,  <span class="dv">44</span>,</span>
<span id="cb33-19"><a href="#cb33-19" tabindex="-1"></a> <span class="dv">45</span>,  <span class="dv">46</span>,  <span class="dv">47</span>,  <span class="dv">48</span>,  <span class="dv">49</span>,  <span class="dv">50</span>,  <span class="dv">51</span>,  <span class="dv">52</span>,  <span class="dv">53</span>,  <span class="dv">54</span>,  <span class="dv">55</span>,</span>
<span id="cb33-20"><a href="#cb33-20" tabindex="-1"></a> <span class="dv">56</span>,  <span class="dv">57</span>,  <span class="dv">58</span>,  <span class="dv">62</span>,  <span class="dv">63</span>,  <span class="dv">64</span>,  <span class="dv">65</span>,  <span class="dv">68</span>,  <span class="dv">70</span>,  <span class="dv">71</span>,  <span class="dv">72</span>,</span>
<span id="cb33-21"><a href="#cb33-21" tabindex="-1"></a> <span class="dv">73</span>,  <span class="dv">74</span>,  <span class="dv">75</span>,  <span class="dv">76</span>,  <span class="dv">77</span>,  <span class="dv">80</span>,  <span class="dv">81</span>,  <span class="dv">82</span>,  <span class="dv">83</span>, <span class="dv">113</span>, <span class="dv">114</span>,</span>
<span id="cb33-22"><a href="#cb33-22" tabindex="-1"></a><span class="dv">115</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">118</span>, <span class="dv">119</span>, <span class="dv">120</span>, <span class="dv">121</span>, <span class="dv">122</span>, <span class="dv">123</span>, <span class="dv">124</span>, <span class="dv">127</span>,</span>
<span id="cb33-23"><a href="#cb33-23" tabindex="-1"></a><span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="dv">131</span>, <span class="dv">132</span>, <span class="dv">163</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">167</span>, <span class="dv">168</span>,</span>
<span id="cb33-24"><a href="#cb33-24" tabindex="-1"></a><span class="dv">169</span>, <span class="dv">174</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">184</span>,</span>
<span id="cb33-25"><a href="#cb33-25" tabindex="-1"></a><span class="dv">185</span>, <span class="dv">186</span>, <span class="dv">187</span>, <span class="dv">188</span>, <span class="dv">189</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">192</span>, <span class="dv">193</span>, <span class="dv">194</span>, <span class="dv">197</span>,</span>
<span id="cb33-26"><a href="#cb33-26" tabindex="-1"></a><span class="dv">198</span>, <span class="dv">199</span>, <span class="dv">200</span>, <span class="dv">201</span>, <span class="dv">202</span>, <span class="dv">208</span>, <span class="dv">209</span>, <span class="dv">210</span>, <span class="dv">211</span>, <span class="dv">212</span>, <span class="dv">213</span>,</span>
<span id="cb33-27"><a href="#cb33-27" tabindex="-1"></a><span class="dv">214</span>, <span class="dv">215</span>, <span class="dv">216</span>, <span class="dv">217</span>, <span class="dv">218</span>, <span class="dv">219</span>, <span class="dv">220</span>, <span class="dv">221</span>, <span class="dv">222</span>, <span class="dv">223</span>, <span class="dv">224</span>,</span>
<span id="cb33-28"><a href="#cb33-28" tabindex="-1"></a><span class="dv">225</span>, <span class="dv">226</span>, <span class="dv">227</span>, <span class="dv">228</span>, <span class="dv">229</span>, <span class="dv">230</span>, <span class="dv">231</span>, <span class="dv">232</span>, <span class="dv">233</span>, <span class="dv">234</span>], bipartite<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<p>We can confirm that the network is bipartite.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>nx.bipartite.is_bipartite(myBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<p>Next, we continue to use the bipartite convention introduced above to
define the two bipartite groups, and set up a custom colouring list by
group.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>top <span class="op">=</span> nx.bipartite.sets(myBipartite)[<span class="dv">0</span>]</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>pos <span class="op">=</span> nx.bipartite_layout(myBipartite, top)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>color_dictionary <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'gold'</span>,<span class="dv">1</span>:<span class="st">'lavender'</span>}</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>color_list <span class="op">=</span> [color_dictionary[i[<span class="dv">1</span>]] <span class="cf">for</span> i <span class="kw">in</span> myBipartite.nodes.data(<span class="st">'bipartite'</span>)]</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">30</span>))</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>nx.draw(myBipartite, pos,</span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1200</span>,</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>        labels<span class="op">=</span>myBipartiteLabels,</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a>        node_color<span class="op">=</span>color_list)</span>
<span id="cb36-14"><a href="#cb36-14" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-24-17.png" width="960" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The graph shows in a preliminary way that there are certain preferred
connections between the two sets, in this case between the frontal group
and the rest of the neurons.</p>
<div id="do-it-yourself-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-5" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-5"></a>
</h3>
<div class="callout-content">
<p>Draw the bipartite neural network, coloured by group and positioned
using the positional information from Dynamic Connectome in the file
‘celegans277positions.csv’.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<p>The 2D positions are contained in the file
‘celegans277positions.csv’. After the import of the file, they can be
extracted into a variable using <code>values</code>. The positions then
need to replace the original layout values (called ‘pos’ above).</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>neuronPos <span class="op">=</span> read_csv(<span class="st">'data/celegans277positions.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>neuronPositions <span class="op">=</span> neuronPos.values</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">20</span>))</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>nx.draw(myBipartite, neuronPositions,</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>        labels<span class="op">=</span>myBipartiteLabels,</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>        node_color<span class="op">=</span>color_list)</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-25-19.png" width="960" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
</section><section id="example-microbiome-network"><h2 class="section-heading">Example: Microbiome network<a class="anchor" aria-label="anchor" href="#example-microbiome-network"></a>
</h2>
<hr class="half-width"><p style="text-align: justify;">
Microbiome data can be collected from a wide variety of environments,
and is generally considered to be the bacterial, fungal, and viral
components of a given environment. <a href="https://doi.org/10.1371/journal.pcbi.1002687" class="external-link">Friedman and Alm
(2012)</a> used data from the <a href="https://www.nature.com/articles/nature11209" class="external-link">Human Microbiome
Project</a> to calculate pairwise interaction correlations for each
operational taxonomic unit (OTU). They then used Python and NetworkX to
analyse and visualise several of these correlation datasets for each
human body site. The challenge here is to extract network information
about a graph from bivariate quantities like the correlation
coefficient.
</p>
<img src="fig/microbiomenetworks.png" class="figure"> As the correlation data are
open access, we can access them and derive the network.
<p style="text-align: justify;">
Data are imported from text files. In this case, it is not a CSV file.
Rather, the data are tab separated. We can adjust for this by specifying
the keyword argument <code>delimiter</code> for tab. As the correlation
coefficients are stored as decimal point numbers, we specify the keyword
argument <code>dtype</code> as floating point ‘float64’.
</p>
<p style="text-align: justify;">
If you check the file, you will see that the first entry is ‘1.0’. This
is because all self-correlations are (trivially) equal to one. We
replace those diagonal values with 0 to avoid (nonsensical)
self-connections in the network.
</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>gutbact      <span class="op">=</span> read_csv(<span class="st">'data/Stool_sparse_adj_matrix.txt'</span>,</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>                        header<span class="op">=</span><span class="va">None</span>, delimiter<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, dtype<span class="op">=</span><span class="st">"float64"</span>)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>gutbactNames <span class="op">=</span> read_csv(<span class="st">'data/Stool_sparse_matrix_names.txt'</span>,</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>                        header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>gutbact<span class="op">=</span> gutbact.to_numpy()</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>fill_diagonal(gutbact, <span class="dv">0</span>)</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>gutbactNames<span class="op">=</span> gutbactNames.to_dict()</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>gutbactLabels <span class="op">=</span> gutbactNames[<span class="dv">0</span>]</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>gutbactGraph <span class="op">=</span> nx.from_numpy_matrix(gutbact)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>gutbactLayout <span class="op">=</span> nx.circular_layout(gutbactGraph)</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">16</span>))</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>nx.draw(gutbactGraph, gutbactLayout,</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'r'</span>,</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>        labels<span class="op">=</span>gutbactLabels)</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-27-21.png" width="1536" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This gives us the correlation network from the stool samples, with nodes
labelled by the OTU number. However, this doesn’t look much like the
data from the article, partly as there are so many edges. The reason is
that any number in the network matrix that is not equal to zero is
interpreted as an edge. Thus, essentially the graph is fully connected.
</p>
<div class="section level3">
<h3 id="functional-networks"><strong>Functional Networks</strong><a class="anchor" aria-label="anchor" href="#functional-networks"></a></h3>
<p style="text-align: justify;">
In the paper, Friedman and Alm (2012), the edges are taken from the
correlation coefficients of the correlation matrix. I.e. they define the
correlation matrix as a network matrix. But the entries of the
correlation matrix are not 0s and 1s as we have used so far. Instead
they are real numbers between -1 and 1. What Friedman and Alm did to
obtain meaningful edges was to pick a threshold correlation, e.g. <span class="math inline">\(|cc| = 0.3\)</span> and set any matrix entry with
absolute value smaller than the threshold as 0. All other values are
left as they are. Because anything non-zero will be interpreted as an
edge, this means that they only plot edges where the correlation
coefficient is greater than 0.3 or less than -0.3. Such networks are
referred to as <em>functional networks</em>.
</p>
<p style="text-align: justify;">
To threshold the correlation matrix in Python, we select matrix values
between -0.3 and 0.3, and replace them with 0. Then we convert this
thresholded network matrix to a graph and plot it.
</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> where, logical_and</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>threshold <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>gutbact_threshold <span class="op">=</span> where(logical_and(gutbact<span class="op">&gt;=-</span>threshold , gutbact<span class="op">&lt;=</span>threshold), <span class="dv">0</span>, gutbact)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>gutbactGraph <span class="op">=</span> nx.from_numpy_matrix(gutbact_threshold)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">16</span>))</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>nx.draw(gutbactGraph, gutbactLayout,</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'r'</span>,</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>        labels<span class="op">=</span>gutbactLabels)</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="fig/03-networks_3-rendered-unnamed-chunk-29-23.png" width="1536" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This network only displays edges where strong correlations were found
and this is how Friedman and Alm obtained their graphs. Note that the
network structure now is a function of the chosen threshold. Smaller
thresholds yield more edges, higher thresholds fewer edges. Choosing the
right threshold may be difficult and needs further thought.
</p>
<p style="text-align: justify;">
The creation of networks from functional data opens a wide field of
research: <em>any</em> interrelation matrix obtained with whatever
metric can be interpreted as a network matrix and converted into a
graph. As an example, see Figure 1 in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3621511/" class="external-link">The Brain
as a Complex System: Using Network Science as a Tool for Understanding
the Brain</a> which describes the procedure for brain imaging.
</p>
<p style="text-align: justify;">
This concludes our set of Lessons on network handling in Python. For
practice, try to find a database that touches on topics of your own
interest. As an example, in the context of the human brain, there is a
rich database at the <a href="http://www.humanconnectomeproject.org/data/" class="external-link">Human Connectome
Database</a>. Each database will present its own challenges and
obstacles. Nevertheless, it is worth to overcome those to be able to
work with the data in Python. Eventually, all functions and dysfunctions
observed in living systems are a consequence of interactions between
components.
</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>
<code>.csv</code> is a common file format when importing network
data.</li>
<li>
<code>JSON</code> is another widely used standard file format which
is language independent.</li>
<li>
<code>FileNotFoundError</code>, <code>KeyError</code> and
<code>Graph is not bipartite</code> are the most common file import
errors.</li>
</ul></div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="02-networks_2.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="index.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="02-networks_2.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Networks -
        </a>
        <a class="chapter-link float-end" href="index.html" rel="next">
          Home
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/LearnToDiscover/sandpaper/tree/l2d" class="external-link">sandpaper (0.16.5.90000.1)</a>, <a href="https://github.com/carpentries/pegboard/tree/a32a7836d4455f407c3cafe8ab95edc636e5e919" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/LearnToDiscover/varnish/tree/b2fb8567ab18b1fa735ee00c788da08c8f93b591" class="external-link">varnish (1.0.3.9000.1)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://learntodiscover.github.io/Networks/03-networks_3.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Networks - Applications",
  "creativeWorkStatus": "active",
  "url": "https://learntodiscover.github.io/Networks/03-networks_3.html",
  "identifier": "https://learntodiscover.github.io/Networks/03-networks_3.html",
  "dateCreated": "2024-05-22",
  "dateModified": "2024-05-22",
  "datePublished": "2024-06-18"
}

  </script><script>
		feather.replace();
	</script></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

