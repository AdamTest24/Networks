<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Networks: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [ ['$','$'], ['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav l2d"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="l2d" src="../assets/images/l2d-logo.svg">
</div>
    </div>
    <div class="selector-container ">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav l2d" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="l2d" src="../assets/images/l2d-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Networks
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
      <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Networks
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"></ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Networks
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress l2d">
    <div class="progress-bar l2d" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
  <div id="sidebar-col" class="col-lg-4">
    <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle"><i class="search-icon" data-feather="x" role="img"></i></button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-networks_1.html">1. Networks - Introduction</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-networks_2.html">2. Networks - Quantification</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-networks_3.html">3. Networks - Applications</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            <br><a href="../instructor/aio.pdf">See all in one page [PDF]</a>

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-networks_1"><p>Content from <a href="01-networks_1.html">Networks - Introduction</a></p>
<hr>
<p> Last updated on 2023-07-11 | 
        
        <a href="https://github.com/LearnToDiscover/Networks.git/edit/main/episodes/01-networks_1.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 120 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p><a href="../01-networks_1.ipynb"><strong>Download Chapter notebook
(ipynb)</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How are graphs represented?</li>
<li>How are graphs visualised?</li>
<li>What are common types of graphs?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understanding the notion of a graph</li>
<li>Explaining nodes and edges represent networks</li>
<li>The network matrix formalism</li>
<li>Visualising graphs</li>
<li>Understanding undirected, directed and bipartite graphs</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/E7rHW3CSREU" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/w1XWeh-A3h0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/zj7kWVH8uck" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<ul>
<li><a href="https://learntodiscover.github.io/Basic_Python/" class="external-link">Basic
Python</a></li>
<li><a href="https://matplotlib.org" class="external-link">Basic Matplotlib</a></li>
</ul>
</div>
</div>
</div>
<section id="example-protein-protein-interactions"><h2 class="section-heading">Example: Protein-protein interactions<a class="anchor" aria-label="anchor" href="#example-protein-protein-interactions"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Protein-protein interactions (PPIs) (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2891586/" class="external-link">PLoS:
Protein–Protein Interactions</a>) refer to specific functional or
physical contact between proteins in vivo. Interactions may be dependent
on biological context, organism, definition of interaction, and many
other factors. An example of PPIs can be seen below.
</p>
<img src="../fig/mazG.png" class="figure"><p style="text-align: justify;">
PPIs may be conceptualised as a network, in order to give greater
context to the protein interactions, and to see how changes to one
protein may affect another protein several steps removed. A PPI network
can be modelled via a graph in which the nodes represent the proteins
and the edges represent interactions: an edge from node A to node B
indicates protein B interacts with protein A. The diagram above shows
the PPI network centred around the protein <span class="math inline">\(mazG\)</span> in <em>Escherichia coli K12
MG1655</em>. This is part of a toxin-antitoxin system. These systems
generally encode pairs of <em>toxin</em> and inhibitory
<em>antitoxin</em> proteins, are transmitted by plasmids, and likely
serve several biological functions including stress tolerance and genome
stabilisation. <span class="math inline">\(mazG\)</span> regulates the
type II toxin-antitoxin system shown in this network, where <span class="math inline">\(mazF\)</span> is the toxin and <span class="math inline">\(mazE\)</span> is the antitoxin. More details on
the proteins in this network can be seen on STRING-DB (<a href="https://version-11-0b.string-db.org/cgi/network?networkId=b6lw5pU2DeQm" class="external-link">STRING-DB:
mazG in E. coli</a>.
</p>
<p style="text-align: justify;">
At the end of this lesson we are going to use Python to draw this PPI
network. Before this however, we shall begin with some examples to
familiarise you with the elements and properties of graphs.
</p>
</section><section id="an-introduction-to-networks"><h2 class="section-heading">An Introduction to Networks<a class="anchor" aria-label="anchor" href="#an-introduction-to-networks"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="what-is-a-graph">
<strong>What is a graph?</strong><a class="anchor" aria-label="anchor" href="#what-is-a-graph"></a>
</h3>
<p style="text-align: justify;">
A graph is an object in mathematics to describe relationships between
objects. A simple example of a visual representation of a graph is given
below.
</p>
<figure><img src="../fig/simple_graph2.png" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This graph contains three objects - <strong>nodes</strong> or
<strong>vertices</strong> - and three links - <strong>edges</strong> or
<strong>arcs</strong> - between the nodes. Graphs can be used to
represent networks. For a formal definition of a graph see, e.g. the <a href="https://en.wikipedia.org/wiki/Graph_theory" class="external-link">Wikipedia entry</a>.
</p>
<p style="text-align: justify;">
If the above graph represented a protein-protein interaction network
then the nodes would represent three proteins and the edges represent
interactions between them. To add further proteins, you add new nodes to
the network. To include further dependencies (when there are more
nodes), you add edges.
</p>
<p>We shall see below how we can build, modify and represent networks in
Python.</p>
</div>
<div class="section level3">
<h3 id="networkx">
<strong>NetworkX</strong><a class="anchor" aria-label="anchor" href="#networkx"></a>
</h3>
<p><a href="https://networkx.org" class="external-link"><strong>NetworkX</strong></a> is a
Python package for the creation, manipulation, and study of the
structure, dynamics, and functions of complex networks.</p>
<p>To use NetworkX and visualise your networks, you can import the whole
package.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> show</span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="nodes-and-edges">
<strong>Nodes and Edges</strong><a class="anchor" aria-label="anchor" href="#nodes-and-edges"></a>
</h3>
<p style="text-align: justify;">
Nodes are a basic unit of network data, and are linked to other nodes by
edges, which show the way(s) in which the nodes are connected or
related. In NetworkX, a range of Python objects, including numbers, text
strings, and networks can be nodes.
</p>
<p>Let’s start by creating an empty graph object and then add some nodes
to it.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>firstGraph <span class="op">=</span> nx.Graph()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>firstGraph.add_node(<span class="st">'Node A'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>firstGraph.add_node(<span class="st">'Node B'</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>firstGraph.add_node(<span class="st">'Node C'</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(firstGraph))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(firstGraph.nodes)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'networkx.classes.graph.Graph'&gt;

['Node A', 'Node B', 'Node C']</code></pre>
</div>
<p style="text-align: justify;">
We have created a graph called <em>firstGraph</em>, added three nodes,
and then printed the type of object and a list of the nodes in this
graph. So far, these nodes have no relationship to each other? To
specify relationships (representing e.g. interactions) we can add edges
to show how the nodes are connected.
</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>firstGraph.add_edge(<span class="st">'Node A'</span>, <span class="st">'Node B'</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>firstGraph.add_edge(<span class="st">'Node A'</span>, <span class="st">'Node C'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>firstGraph.add_edge(<span class="st">'Node B'</span>, <span class="st">'Node C'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(firstGraph.edges)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[('Node A', 'Node B'), ('Node A', 'Node C'), ('Node B', 'Node C')]</code></pre>
</div>
<p style="text-align: justify;">
Here we created edges between Nodes A and B, A and C, and B and C, and
printed a list of these edges. We can also get a summary of how many
nodes and edges our graph currently has. At this stage, our graph should
have three nodes and three edges. Here is how to check that in NetworkX.
</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>firstGraph.number_of_nodes()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>firstGraph.number_of_edges()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">3</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="visualising-networks">
<strong>Visualising networks</strong><a class="anchor" aria-label="anchor" href="#visualising-networks"></a>
</h3>
<p>We have a basic graph called <code>firstGraph</code>, so let’s
visualise it. In NetworkX, we can use function <code>draw</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>nx.draw(firstGraph)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
With the default settings, we get a triangle with three blue nodes in
the corners, connected by three lines. There are no arrowheads on the
lines, the network is therefore referred to as <em>undirected</em>.
</p>
<p style="text-align: justify;">
To make the graph less abstract, we can add labels to the nodes. This is
done setting up a dictionary where we use as <code>keys</code> the names
given to the nodes when they were set up. The single <code>value</code>
is the label to be used for the display.
</p>
<p style="text-align: justify;">
Through NetworkX we can also dictate the way the nodes are positioned by
setting a <em>layout</em>. There are many options, and we are using the
<em>spiral</em> layout as an example. For a list of layout options,
please check the <a href="https://networkx.org/documentation/stable/reference/drawing.html#module-networkx.drawing.layout" class="external-link">NetworkX
documentation</a>.
</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>firstGraphLayout <span class="op">=</span> nx.spiral_layout(firstGraph)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>firstGraphLabels <span class="op">=</span> {</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   key     : value</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Node A'</span>: <span class="st">'A'</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Node B'</span>: <span class="st">'B'</span>,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Node C'</span>: <span class="st">'C'</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>nx.draw(firstGraph, firstGraphLayout,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>firstGraphLabels)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-7-3.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="note" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h3>
<div class="callout-content">
<p>We use <code>draw</code> providing the graph object followed by the
(optional) layout as positional arguments. Other keyword arguments (here
the labels) are then added, separated by comma.</p>
</div>
</div>
</div>
<div id="saving-figures" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="saving-figures" class="callout-inner">
<h3 class="callout-title">Saving Figures<a class="anchor" aria-label="anchor" href="#saving-figures"></a>
</h3>
<div class="callout-content">
<p>If you want to save a network graph to a file, you can use function
<code>savefig</code>. Here is an example that will save the figure in
the folder with the code.</p>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> savefig</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>firstGraphLayout <span class="op">=</span> nx.spiral_layout(firstGraph)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>firstGraphLabels <span class="op">=</span> {</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Node A'</span>: <span class="st">'A'</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Node B'</span>: <span class="st">'B'</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Node C'</span>: <span class="st">'C'</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>nx.draw(firstGraph, firstGraphLayout,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>firstGraphLabels)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>savefig(<span class="st">'my_network.png'</span>, <span class="bu">format</span><span class="op">=</span><span class="st">'png'</span>)<span class="op">;</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-9-5.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
You may want to alter the appearance of your graph in different ways.
Let’s say you want the nodes to be red: you achieve this by using the
keyword argument <code>node_color</code>.
</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>nx.draw(firstGraph, firstGraphLayout,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>firstGraphLabels,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-10-7.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Note that, as always, the spelling is the US version, ‘color’.</p>
</div>
</section><section id="creating-a-network-matrix"><h2 class="section-heading">Creating a Network Matrix<a class="anchor" aria-label="anchor" href="#creating-a-network-matrix"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
A generic way to define graphs is via a two dimensional array known as
the <strong>network matrix</strong> or <strong>adjacency
matrix</strong>. We won’t go into the details of matrices here but will
just show you how to create them in Python.
</p>
<p style="text-align: justify;">
For our purpose a matrix is a collection of numbers. Let us start by
creating a matrix that contains only zeroes. A very easy way to create a
matrix with zeroes in Python is using <code>zeros</code> from Numpy. The
number of network nodes is equal to the number of rows and columns in
the array.
</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> zeros</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>my_matrix <span class="op">=</span> zeros((nodes, nodes))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_matrix)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[0. 0. 0.]
 [0. 0. 0.]
 [0. 0. 0.]]</code></pre>
</div>
<p style="text-align: justify;">
We have given the <code>zeros</code> function two arguments, 3 and 3,
and it has created an array of 9 numbers (all of value 0) arranged into
3 rows and 3 columns. This is a <strong>square matrix</strong> because
the number of rows is equal to the number of columns. We say that this
matrix is of dimension <span class="math inline">\(3\times 3\)</span>.
</p>
<p style="text-align: justify;">
To check the dimensions of a Numpy array, you can use
<code>shape</code>. Since in the above code we have assigned the matrix
to the variable <code>my_matrix</code> we can call it as follows.
</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>my_matrix.shape</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(3, 3)</code></pre>
</div>
<div id="note-1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note-1" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note-1"></a>
</h3>
<div class="callout-content">
<p>Note that <code>shape</code> does not take arguments. It returns the
dimensions of the matrix as an array of length 2; the first element is
the number of rows and the second element is the number of columns.</p>
</div>
</div>
</div>
<p style="text-align: justify;">
We can now access each element of <code>my_matrix</code> and change its
value. To change the element in the second row and the third column we
use the syntax <code>my_matrix[1, 2]</code> where we first specify the
row index and the column index second, separated by a comma.
</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>my_matrix[<span class="dv">2</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>my_matrix[<span class="dv">1</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(my_matrix)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[0. 0. 0.]
 [1. 0. 0.]
 [1. 0. 0.]]</code></pre>
</div>
<div id="do-it-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself"></a>
</h3>
<div class="callout-content">
<p>Create a 4x4 matrix called <span class="math inline">\(n\)</span> and
set the elements <span class="math inline">\(n_{0,1}=1\)</span>, <span class="math inline">\(n_{1,2}=1\)</span> and <span class="math inline">\(n_{1,3}=1\)</span>.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> zeros((<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>n[<span class="dv">0</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>n[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>n[<span class="dv">1</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(n)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[0. 1. 0. 0.]
 [0. 0. 1. 1.]
 [0. 0. 0. 0.]
 [0. 0. 0. 0.]]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="representing-graphs"><h2 class="section-heading">Representing graphs<a class="anchor" aria-label="anchor" href="#representing-graphs"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Now we shall see how a <span class="math inline">\(3 \times 3\)</span>
square matrix can represent a graph with three nodes which we call <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>
and <span class="math inline">\(C\)</span>. Consider the following table
where we have taken the matrix elements and labelled both the rows and
the columns <span class="math inline">\(A,B\)</span> and <span class="math inline">\(C\)</span>.
</p>
<figure><img src="../fig/matrix_vis.png" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This matrix can represent a graph with three nodes. The value of 1 in
the first row and the second column indicates that there is an
<strong>edge</strong> from node <span class="math inline">\(A\)</span>
to node <span class="math inline">\(B\)</span>. Therefore, the row
position indicates the node that an edge emanates from and the column
position indicates the node that the edge ends on.
</p>
<p>We can see that there are four edges in this graph:</p>
<ul>
<li><p>from node <span class="math inline">\(A\)</span> to node <span class="math inline">\(B\)</span></p></li>
<li><p>from node <span class="math inline">\(B\)</span> to node <span class="math inline">\(A\)</span></p></li>
<li><p>from node <span class="math inline">\(B\)</span> to node <span class="math inline">\(C\)</span></p></li>
<li><p>from node <span class="math inline">\(C\)</span> to node <span class="math inline">\(A\)</span></p></li>
</ul>
<div id="do-it-yourself-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-1" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-1"></a>
</h3>
<div class="callout-content">
<p>For the matrix, <span class="math inline">\(n\)</span>, created in
Exercise 1.1, is a network matrix representing a graph, use code to
check the number of nodes and edges.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<pre><code>The graph has four nodes and three edges.
$n_{0,1} $ or $n[0][1]$ is an edge from node 0 to node 1.
$n_{1,2}$ or $n[1][2]$ is an edge from node 1 to node 2.
$n_{1,3}$ or $n[1][3]$ is an edge from node 1 to node 3.</code></pre>
</div>
</div>
</div>
</div>
</section><section id="different-layouts-for-visualisation"><h2 class="section-heading">Different Layouts for Visualisation<a class="anchor" aria-label="anchor" href="#different-layouts-for-visualisation"></a>
</h2>
<hr class="half-width">
Now that we know how to create a matrix which can represent the graph,
we want to know what the graph coming from this matrix looks like.
<p style="text-align: justify;">
First, we set up the network (or: adjacency) matrix in the above table
from scratch. Then we use NetworkX function
<code>from_numpy_matrix</code> to turn our matrix into a NetworkX Graph
object called <code>new_graph</code>. We set the layout to a spiral
layout (as we did before) and then draw the graph.
</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>new_matrix <span class="op">=</span> zeros((<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>new_matrix[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>new_matrix[<span class="dv">2</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>new_matrix[<span class="dv">0</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>new_matrix[<span class="dv">1</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>new_graph <span class="op">=</span> nx.from_numpy_matrix(new_matrix)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>newLayout <span class="op">=</span> nx.spiral_layout(new_graph)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>nx.draw(new_graph, newLayout)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-15-9.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We haven’t specified labels. We can specify the labels using a
dictionary. Let us first see how the nodes are stored to find their
Python names.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">list</span>(new_graph.nodes)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[0, 1, 2]</code></pre>
</div>
<p>By default, the nodes are given the names of their indices. We can
refer to these indices and assign labels.</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>newLabels <span class="op">=</span> {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># key : value</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre>
</div>
<p>We can now draw the graph again, and specify the new labels A, B, and
C.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nx.draw(new_graph, newLayout,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>newLabels)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-18-11.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
There are many different options available for drawing graphs. Use
<code>help(nx.draw)</code> to get a description of the options available
for the graph as a whole, the nodes and the edges.
</p>
<p style="text-align: justify;">
We shall first experiment with the graph layout. Converting a
mathematical description of a graph, i.e. an adjacency matrix, to a
graphical description is a difficult problem, especially for large
graphs. The algorithms that perform this operation are known as graph
layout algorithms and NetworkX has many of them implemented. We used
<code>spiral_layout</code> to produce the drawing above. Further
specifications can be made within each layout, and you can access the
details with <span class="math inline">\(help\)</span>.
</p>
<p>Some graph layout algorithms have a random component such as the
initial position of the nodes. This means that different realisations of
the layouts will not be identical.</p>
<div id="do-it-yourself-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-2" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-2"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Use the graph layout algorithm called <code>shell_layout</code>
to plot <code>new_graph</code>.</p></li>
<li><p>Draw the graph with a third layout algorithm called
<code>random_layout</code>. Execute the code to draw the graph several
times.</p></li>
<li><p>Draw the graph from the matrix <span class="math inline">\(n\)</span>, created in Exercise 1.1 with the
layout algorithm <code>spectral_layout</code>. Give the nodes the names
<span class="math inline">\(V\)</span>, <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span>
and <span class="math inline">\(Z\)</span>.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Q1
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>newLayout <span class="op">=</span> nx.shell_layout(new_graph)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>nx.draw(new_graph, newLayout,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>newLabels)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-19-13.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Q2
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>newLayout <span class="op">=</span> nx.random_layout(new_graph)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>nx.draw(new_graph, newLayout)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>show()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The layout of this graph changes each time you run the code.</span></span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-20-15.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Q3
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>n <span class="op">=</span> zeros((<span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>n[<span class="dv">0</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>n[<span class="dv">1</span>, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>n[<span class="dv">1</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>new <span class="op">=</span> nx.from_numpy_matrix(n)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>newLabels <span class="op">=</span> {</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'V'</span>,</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'X'</span>,</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'Y'</span>,</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'Z'</span>,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>newLayout <span class="op">=</span> nx.spectral_layout(new)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>nx.draw(new, newLayout,</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>newLabels)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-21-17.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="customising-nodes-and-edges"><h2 class="section-heading">Customising nodes and edges<a class="anchor" aria-label="anchor" href="#customising-nodes-and-edges"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Now we are going to look at some ways to access and change some
properties, or attributes, of the nodes in the graph. We have already
changed the node colour from blue to red. Let’s say we want to change
the colour to gold (for a list of available names see <a href="https://matplotlib.org/3.1.0/gallery/color/named_colors.html" class="external-link">matplotlib:
plot colours</a>), change the node shapes to hexagons (<a href="https://matplotlib.org/3.1.1/api/markers_api.html" class="external-link">matplotlib:
node shapes</a>), and increase the node size. This plot will vary each
time you run it, due to the layout algorithm.
</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>new_graph <span class="op">=</span> nx.from_numpy_matrix(new_matrix)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>newLayout <span class="op">=</span> nx.random_layout(new_graph)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>newLabels <span class="op">=</span> {</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>nx.draw(new_graph, newLayout,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>newLabels,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'gold'</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>        node_shape<span class="op">=</span><span class="st">"H"</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">2000</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-22-19.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
You may want to add another node, but only have it connected to one of
the existing nodes. Here we add a new node, which is the number 3
(because Python indexes from zero). You can print the nodes and see that
you now have four.
</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>new_graph.add_node(<span class="dv">3</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_graph.nodes)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[0, 1, 2, 3]</code></pre>
</div>
<p style="text-align: justify;">
We may want to set a new layout for this graph and update the labels to
call the new node ‘D’. You will see that the new node is not connected
to any other node, because we have not specified how it relates to the
other nodes.
</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>newLayout <span class="op">=</span> nx.random_layout(new_graph)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>newLabels <span class="op">=</span> {</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'D'</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>nx.draw(new_graph, newLayout,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>newLabels,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'gold'</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>        node_shape<span class="op">=</span><span class="st">"H"</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">800</span>)<span class="op">;</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-24-21.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
We discussed above changing the colour of the nodes in our graph. There
are several ways you can specify colour in Python (<a href="https://matplotlib.org/3.1.1/api/markers_api.html" class="external-link">matplotlib:
node shapes</a>). The RGB format is one of these methods used for
specifying a colour. The colour is specified via an array of length 3
containing the relative amounts of Red, Green, and Blue. Red is
specified via <span class="math inline">\([[1, 0, 0]]\)</span>, blue via
<span class="math inline">\([[0, 0, 1]]\)</span> and green via <span class="math inline">\([[0, 1, 0]]\)</span>. As special cases, <span class="math inline">\([[0, 0, 0]]\)</span> will give you black, and
<span class="math inline">\([[1, 1, 1]]\)</span> will give white.
</p>
<div id="do-it-yourself-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-3" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-3"></a>
</h3>
<div class="callout-content">
<p>Add an edge to the network to connect the isolated node D to
e.g. node A.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>new_graph.add_edge(<span class="dv">3</span>, <span class="dv">0</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>nx.draw(new_graph, newLayout,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>newLabels,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'gold'</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        node_shape<span class="op">=</span><span class="st">"H"</span>,</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">800</span>)<span class="op">;</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-25-23.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<p style="text-align: justify;">
Instead of altering individual elements of a matrix with zeroes (as we
have done above) you can also create a graph directly from a Numpy
array. You set up a nested list and convert it to a Numpy array using
<code>array</code>.
</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> array</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>matrixFromArray <span class="op">=</span>  array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>                          [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>                          [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>                          [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>my_graph <span class="op">=</span> nx.from_numpy_matrix(matrixFromArray, create_using<span class="op">=</span>nx.DiGraph())</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>my_graphLayout <span class="op">=</span> nx.spring_layout(my_graph)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>nx.draw(my_graph, my_graphLayout)</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-26-25.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="do-it-yourself-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-4" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-4"></a>
</h3>
<div class="callout-content">
<p>Set all the nodes in this graph to turquoise diamonds. By turquoise
we mean the RGB colour <span class="math inline">\([[0, 1,
1]]\)</span></p>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" aria-labelledby="headingSolution7" data-bs-parent="#accordionSolution7">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>nx.draw(my_graph, newLayout,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>newLabels,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span>[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>]],</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>        node_shape<span class="op">=</span><span class="st">"D"</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-27-27.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>A number of prototypic networks are the fully connected network (each
node is connected to all other nodes); the random network (each node is
connected to a random subset of other nodes); and the Watts-Strogatz
network (a network with a combination of systematically and randomly
assigned edges). They are demonstrated in a video tutorial accompanying
this Lesson.</p>
</div>
</div>
</div>
</div>
</section><section id="directed-graphs"><h2 class="section-heading">Directed graphs<a class="anchor" aria-label="anchor" href="#directed-graphs"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
So far, we have been working with <em>undirected</em> graphs: all the
edges between the nodes were independent of the direction in which they
were set up and thus represented as lines without arrowheads. Such
networks are also referred to as <em>bidirectional</em>. For some
systems, such as biochemical reactions, a <em>directed</em> graph is
more suited, and gives us more detail on the relationships represented
in the network.
</p>
<p style="text-align: justify;">
In NetworkX, directed graphs are handled using the class
<code>DiGraph</code>. We can make a simple DiGraph by importing a matrix
as above, but specifying that it is a directed graph.
</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>directedMatrix <span class="op">=</span>  array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]])</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>directed <span class="op">=</span> nx.from_numpy_matrix(directedMatrix, create_using<span class="op">=</span>nx.DiGraph)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>directedLayout <span class="op">=</span> nx.spiral_layout(directed)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>directedLabels <span class="op">=</span> {</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'D'</span>,</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>nx.draw(directed, directedLayout,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>directedLabels)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-28-29.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
You’ll be able to see in this graph that the edges now have arrow tips
indicating the direction of the edge. The edge between node A and node D
has an arrow tip on each end, indicating that edge is bidirectional.
Node B is also connected to itself.
</p>
<p style="text-align: justify;">
In NetworkX convention an edge is set up in a network matrix in the
direction row <span class="math inline">\(\rightarrow\)</span> column.
Thus, a given row tells us which edges leave the node with that row
number. A given column tells us which edges arrive at the node with that
column number. Thus the bidirectional edge between node A and node D is
given by directedMatrix<span class="math inline">\(_{3,0}\)</span> and
directedMatrix<span class="math inline">\(_{0,3}\)</span> both being
equal to 1.
</p>
<p>An entry on the diagonal, directedMatrix<span class="math inline">\(_{1,1}\)</span>, is used for self-connection of
node B.</p>
<div id="do-it-yourself-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-5" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-5"></a>
</h3>
<div class="callout-content">
<p>Change directedMatrix<span class="math inline">\(_{3,2}\)</span> to
1. What does this change about the graph?</p>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" aria-labelledby="headingSolution8" data-bs-parent="#accordionSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>directedMatrix <span class="op">=</span>  array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                         [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]])</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>directedMatrix[<span class="dv">3</span>, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>directed <span class="op">=</span> nx.from_numpy_matrix(directedMatrix, create_using<span class="op">=</span>nx.DiGraph)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>directedLayout <span class="op">=</span> nx.spiral_layout(directed)</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>directedLabels <span class="op">=</span> {</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'D'</span>,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>nx.draw(directed, directedLayout,</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>directedLabels)</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-29-31.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="bipartite-graphs"><h2 class="section-heading">Bipartite graphs<a class="anchor" aria-label="anchor" href="#bipartite-graphs"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Bipartite graphs are another graph type supported by NetworkX. These are
networks which are made up of two groups of nodes which connect to nodes
in the other group, but not with other nodes in the same group. Some
ecological, biomedical, and epidemiological networks may be represented
by bipartite networks. In NetworkX there is not a specific bipartite
class of graphs, but both the undirected and directed methods we have
used earlier may be used to represent bipartite graphs. However, it is
recommended to add an attribute to the nodes in your two groups to help
you differentiate them. The convention in NetworkX is to assign one
group of nodes an attribute of 0, and the other an attribute of 1.
</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> networkx.algorithms <span class="im">import</span> bipartite</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>myBipartite <span class="op">=</span> nx.Graph()</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Add nodes with the node attribute "bipartite"</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>myBipartite.add_nodes_from([<span class="st">'h'</span>, <span class="st">'i'</span>, <span class="st">'j'</span>, <span class="st">'k'</span>], bipartite<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>myBipartite.add_nodes_from([<span class="st">'q'</span>, <span class="st">'r'</span>, <span class="st">'s'</span>, <span class="st">'t'</span>], bipartite<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add edges only between nodes of opposite node sets</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>myBipartite.add_edges_from([(<span class="st">'h'</span>, <span class="st">'q'</span>),</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                            (<span class="st">'h'</span>, <span class="st">'r'</span>),</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                            (<span class="st">'i'</span>, <span class="st">'r'</span>),</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>                            (<span class="st">'i'</span>, <span class="st">'s'</span>),</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>                            (<span class="st">'j'</span>, <span class="st">'s'</span>),</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>                            (<span class="st">'k'</span>, <span class="st">'q'</span>),</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                            (<span class="st">'h'</span>, <span class="st">'t'</span>)])</span></code></pre>
</div>
<p style="text-align: justify;">
Here, we set up a bipartite network with 8 nodes. The 0 group has nodes
<span class="math inline">\('h', 'i', 'j',
'k'\)</span>, and the 1 group has nodes <span class="math inline">\('q', 'r', 's',
't'\)</span>. The specified edges link nodes from the two groups
with each other, but not to any nodes within their own group. NetworkX
has a function to check your nodes are connected.
</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>nx.is_connected(myBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<p style="text-align: justify;">
This will return either true or false. Be cautious though, this only
tests for connection, not whether your graph is truly bipartite. You can
use the function <code>nx.is_bipartite(myBipartite)</code> from
<code>networkx.algorithms</code> to test whether your network is
bipartite. It will return <code>TRUE</code> if your NetworkX object is
bipartite.
</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>bipartite.is_bipartite(myBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<p style="text-align: justify;">
We can now plot the bipartite graph, using the layout of your choice. if
we include the term <span class="math inline">\(with\_labels =
True\)</span> as we draw the graph, the node names we set earlier become
the node labels.
</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>myBipartiteLayout <span class="op">=</span> nx.spiral_layout(myBipartite)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>nx.draw(myBipartite, myBipartiteLayout,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">2000</span>,</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-33-33.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This might not look like a bipartite network! But if you check the edges
you set up earlier, this is bipartite as no node has an edge with
another node in each group. If we want it to look more like a classic
bipartite network, we can use the attributes we set up earlier and the
module <span class="math inline">\(networkx.algorithms\)</span> to make
a custom layout and more clearly visualise the bipartite nature of this
graph.
</p>
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>groupzero <span class="op">=</span> nx.bipartite.sets(myBipartite)[<span class="dv">0</span>]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>bipartitePos <span class="op">=</span> nx.bipartite_layout(myBipartite, groupzero)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>nx.draw(myBipartite, bipartitePos,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">2000</span>,</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>        with_labels <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-34-35.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
Using the bipartite convention of giving one group of nodes the
attribute 0 and the other 1 means that you can use this to change other
aspects of your graph, such as colour. Here, we use the attributes of
the nodes to assign a colour to each group of nodes. The colour list can
then be included in the plot.
</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>color_dictionary <span class="op">=</span> {<span class="dv">0</span>: <span class="st">'gold'</span>, <span class="dv">1</span>: <span class="st">'lavender'</span>}</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> attr <span class="kw">in</span> myBipartite.nodes.data(<span class="st">'bipartite'</span>):</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    color_list.append(color_dictionary[attr[<span class="dv">1</span>]])</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(color_list)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['gold', 'gold', 'gold', 'gold', 'lavender', 'lavender', 'lavender', 'lavender']</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>nx.draw(myBipartite, bipartitePos,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">2000</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>        font_size<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span>color_list)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-36-37.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
A readable introduction to bipartite networks and their application to
gene-disease networks can be found in section 2.7 of the online textbook
<a href="http://networksciencebook.com/chapter/2#bipartite-networks" class="external-link">Network
Science by A.L. Barabási</a>.
</p>
</section><section id="exercises"><h2 class="section-heading">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<hr class="half-width">
<div id="assignment-the-toxin-antitoxin-network" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="assignment-the-toxin-antitoxin-network" class="callout-inner">
<h3 class="callout-title">Assignment: the Toxin-Antitoxin Network<a class="anchor" aria-label="anchor" href="#assignment-the-toxin-antitoxin-network"></a>
</h3>
<div class="callout-content">
<p>Use code to create the (undirected) toxin-antitoxin PPI network given
at the start of this example. Experiment with the different layout
algorithms, the node colour and shape, and the edge color.</p>
<p>Hint:</p>
<ul>
<li>Using pen and paper, draw a diagram of the PPI network.</li>
<li>Decide on the ordering of the nodes. I chose to start with the
centre node, and then number them in an anticlockwise direction.
(<strong>Hint:</strong> There are 11 nodes in total.)</li>
<li>Label your pen and paper diagram with the node numbers.</li>
<li>Work out all the edges in the graph. Note the numbers of the node at
the start of the edge and the node at the end of the edge.
(<strong>Hint:</strong> There are 20 edges in total.)</li>
<li>Define a <span class="math inline">\(11 \times 11\)</span> matrix in
Python using the Numpy <code>zeros</code> function.</li>
<li>For each edge, set the corresponding entry in the matrix to 1 (start
node number corresponds to row number and end node number corresponds to
column number in the adjacency matrix).</li>
<li>Define a cell array containing your node names and create a NetworkX
object.</li>
<li>Experiment with the layout, colours, node shapes etc.</li>
</ul>
<p>Remember to use the Python documentation, e.g. using
<code>help()</code> if you have problems (or alternatively use a search
engine such as Google).</p>
<p>To save the graph as an image file, use <code>savefig</code> as we
did earlier.</p>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">
  Please check these solutions only after submitting the assignments.
  </h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" aria-labelledby="headingSolution9" data-bs-parent="#accordionSolution9">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> zeros</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>ppi <span class="op">=</span> zeros((<span class="dv">11</span>,<span class="dv">11</span>))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>ppiLabels <span class="op">=</span> {</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'mazG'</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'mazE'</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'mazF'</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'relA'</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'era'</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'rpo2'</span>,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">6</span>: <span class="st">'dcd'</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">7</span>: <span class="st">'pyrG'</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="dv">8</span>: <span class="st">'adk'</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="dv">9</span>: <span class="st">'cpdA'</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="dv">10</span>: <span class="st">'ygdH'</span>,</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">0</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">2</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">0</span>, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">2</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">0</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">1</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">4</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">5</span>, <span class="dv">3</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">4</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">5</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">5</span>, <span class="dv">6</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">5</span>, <span class="dv">7</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">0</span>, <span class="dv">7</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">8</span>, <span class="dv">7</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">8</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">8</span>, <span class="dv">9</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">8</span>, <span class="dv">10</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">0</span>, <span class="dv">9</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">9</span>, <span class="dv">10</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>ppi[<span class="dv">0</span>, <span class="dv">10</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>ppiGraph <span class="op">=</span> nx.from_numpy_matrix(ppi)</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>ppiLayout <span class="op">=</span> nx.spring_layout(ppiGraph)</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>nx.draw(ppiGraph, ppiLayout,</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>              labels<span class="op">=</span>ppiLabels,</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>              node_size<span class="op">=</span><span class="dv">1800</span>,</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>              node_color<span class="op">=</span><span class="st">'lightseagreen'</span>,</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>              node_shape<span class="op">=</span><span class="st">"8"</span>)</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/01-networks_1-rendered-unnamed-chunk-37-39.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>A Python package <code>NetworkX</code> is used for studying
undirected and directed graphs.</li>
<li>A function <code>savefig</code> is used to save a graph to a
file.</li>
<li>
<code>network matrix</code> or <code>adjacency matrix</code> is a
generic way to create graphs as two dimensional array.</li>
<li>In <code>NetworkX</code>, directed graphs are handled using the
class <code>DiGraph</code>.</li>
<li>Bipartite graphs are made up of two groups of nodes which connect to
nodes in the other group, but not with other nodes in the same
group.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-02-networks_2"><p>Content from <a href="02-networks_2.html">Networks - Quantification</a></p>
<hr>
<p> Last updated on 2023-07-11 | 
        
        <a href="https://github.com/LearnToDiscover/Networks.git/edit/main/episodes/02-networks_2.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 120 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p><a href="../02-networks_2.ipynb"><strong>Download Chapter notebook
(ipynb)</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How to generate test matrices using NetworkX?</li>
<li>What is the purpose of the node degree and the degree
distribution?</li>
<li>How can a network be quantified?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Creating network matrices with random edges.</li>
<li>Quantifying network properties.</li>
<li>Applying networks concepts to the C. elegans neural network.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/nU8ossLYBc4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/3MQNgrtjY-A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<br><p align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/FLF-Hz_PhFs" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen>
</iframe>
</p>
<p><br></p>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<ul>
<li><a href="01-networks_1.html">Introduction to Networks</a></li>
</ul>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, show</span></code></pre>
</div>
<section id="generating-test-matrices"><h2 class="section-heading">Generating Test Matrices<a class="anchor" aria-label="anchor" href="#generating-test-matrices"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
NetworkX has a number of ways to create matrices with given
specifications. We have seen in the previous lesson that
e.g. <code>zeros((5,5))</code> creates a <span class="math inline">\(5\times 5\)</span> matrix filled with zeroes. This
speeds up the creation of a network matrix with only a few non-zero
entries. Similarly, one can start with function <code>ones</code> from
Numpy to create a network with few zero entries.
</p>
<p style="text-align: justify;">
However, to test network code we would like to be able to easily create
test matrices without having to fill in the information about the edges
manually. Typically, one wants to quickly create an arbitrary number of
realisations to study e.g. a distribution of network properties.
</p>
<p>Here is a way to create matrices with randomly assigned edges using
function <code>randint</code>.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> randint</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>rm <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(nodes, nodes))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rm)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[0 1 0 1 0]
 [0 0 0 1 1]
 [1 0 0 1 1]
 [1 0 0 1 1]
 [1 0 0 1 1]]</code></pre>
</div>
<p>Function <span class="math inline">\(randint\)</span> from the numpy
module <span class="math inline">\(random\)</span> is used to create an
array or matrix filled with integers.</p>
<p style="text-align: justify;">
The first two arguments, two integer numbers, specify which integers to
use. The first number is the smallest integer, the second number is the
largest integer plus one. The first two numbers work as <span class="math inline">\((a, b+1)\)</span> so this function will produce
numbers (N) in range specified as: <span class="math inline">\(a &lt;= N
&lt;= b\)</span>. In our case entering <span class="math inline">\((0,
2)\)</span> will produce zeroes and ones. With <span class="math inline">\((1, 10)\)</span>, all integers from 1 to 9 will be
used, all with equal probability.
</p>
<p style="text-align: justify;">
The keyword argument <code>size</code> specifies the dimensions of the
matrix. In our case we want a <span class="math inline">\(nodes\times
nodes\)</span> matrix for a specified number of nodes. The output of the
code will look different at each function call because each time you
execute the code, Python will assign the zeroes and ones randomly.
</p>
<p style="text-align: justify;">
There are many ways to create network matrices with different
specifications. These can be used to test null hypotheses about
experimental data. For example, one can generate networks with the same
amount of nodes and edges as in an experimental network but with random
assignment of edges to test whether the observed connections are likely
to be due to chance. Some biological networks seem to have the so-called
<a href="https://en.wikipedia.org/wiki/Small-world_network" class="external-link">‘small
world’ property</a>, where in spite of relatively few connections there
are quick ways to get from one node to any other node by tracing a path
along combinations of edges.
</p>
<p style="text-align: justify;">
There is a way to have Python return the <em>same</em> random numbers
when using functions like <span class="math inline">\(randint\)</span>
by using the <span class="math inline">\(seed\)</span> function (also
from the module <span class="math inline">\(random\)</span>).
Reproducibility is central to coding, and functions such as this
facilitate reproducibility.
</p>
<p style="text-align: justify;">
The command <span class="math inline">\(seed(1)\)</span> sets the value
of the ‘seed’ used to initialise the random number generator to <span class="math inline">\(1\)</span>. The choice of seed value is arbitrary.
The important thing is that specifying a value will mean the random
number results are reproducible.
</p>
<p style="text-align: justify;">
When we specify a starting seed value for the number generator it still
produces random numbers but will produce the same set of random numbers
each time the code is executed. To test this run the following example:
</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> seed</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>seed(<span class="dv">1</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>rm1 <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(nodes, nodes))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rm1)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1 1 0 0 1]
 [1 1 1 1 0]
 [0 1 0 1 1]
 [0 0 1 0 0]
 [0 1 0 0 1]]</code></pre>
</div>
<p>And repeated:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>seed(<span class="dv">1</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>rm2 <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(nodes, nodes))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rm2)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1 1 0 0 1]
 [1 1 1 1 0]
 [0 1 0 1 1]
 [0 0 1 0 0]
 [0 1 0 0 1]]</code></pre>
</div>
<p>Since we set the same (arbitrary) seed for both of these function
calls, both produce the same pattern of 1s and 0s. The results are
identical:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rm1 <span class="op">==</span> rm2</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>array([[ True,  True,  True,  True,  True],
       [ True,  True,  True,  True,  True],
       [ True,  True,  True,  True,  True],
       [ True,  True,  True,  True,  True],
       [ True,  True,  True,  True,  True]])</code></pre>
</div>
<div id="do-it-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself"></a>
</h3>
<div class="callout-content">
<p>Create a <span class="math inline">\(n\times m\)</span> matrix with
randomly distributed integers from 1 to 6 to simulate a group of 3
players throwing a dice 20 times.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>players <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>rounds  <span class="op">=</span> <span class="dv">20</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>throws <span class="op">=</span> randint(<span class="dv">1</span>, <span class="dv">7</span>, size<span class="op">=</span>(rounds, players))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(throws)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[5 3 5]
 [6 3 5]
 [2 2 1]
 [6 2 2]
 [6 2 2]
 [1 5 2]
 [1 1 6]
 [4 3 2]
 [1 4 6]
 [2 2 4]
 [5 1 2]
 [4 5 3]
 [5 1 6]
 [4 2 3]
 [1 5 2]
 [3 3 2]
 [1 2 4]
 [6 5 4]
 [6 2 4]
 [1 1 3]]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="networkx-graph-types"><h2 class="section-heading">NetworkX graph types<a class="anchor" aria-label="anchor" href="#networkx-graph-types"></a>
</h2>
<hr class="half-width">
<p>NetworkX has built-in function to produce classic graphs. For
example, a <a href="https://en.wikipedia.org/wiki/Petersen_graph" class="external-link">Petersen graph</a>
has 10 nodes and 15 edges.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>petersen <span class="op">=</span> nx.petersen_graph()</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>layout <span class="op">=</span> nx.spectral_layout(petersen)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>nx.draw(petersen, with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Some stochastic graphs can also be generated simply within NetworkX.
A random lobster graph is a graph which becomes a caterpillar graph if
all leaf nodes are removed.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># p1: Probability of adding an edge to the backbone</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># p2: Probability of adding an edge one level beyond backbone</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> <span class="fl">0.9</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>p2 <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>lobster <span class="op">=</span> nx.random_lobster(nodes, <span class="fl">0.9</span>, <span class="fl">0.5</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>layout <span class="op">=</span> nx.spiral_layout(lobster)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>nx.draw(lobster, layout, with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-8-3.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
The first argument is the number of nodes in the graph backbone, the
second argument is the probability of adding an edge to this main
backbone, and the third number gives the probability of adding further
edges. Try running it several times, and with different values, to see
how it changes.
</p>
<div id="do-it-yourself-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-1" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-1"></a>
</h3>
<div class="callout-content">
<p>Look up the NetworkX documentation, and use the tutorial to plot a <a href="https://en.wikipedia.org/wiki/Tutte_graph" class="external-link">Tutte graph</a>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tutte <span class="op">=</span> nx.tutte_graph()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>layout <span class="op">=</span> nx.spring_layout(tutte, seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>nx.draw(tutte, layout,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-9-5.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="node-degree"><h2 class="section-heading">Node degree<a class="anchor" aria-label="anchor" href="#node-degree"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Each node within a graph has a number of edges connected to it and this
number is referred to as the node (or vertex) <strong>degree</strong>.
For example, consider the protein-protein interation graph generated in
the previous Lesson, Exercise 1.5.
</p>
<figure><img src="../fig/mazG.png" class="figure mx-auto d-block"></figure>
The node representing the protein <span class="math inline">\(adk\)</span> has a degree of 4 and <span class="math inline">\(era\)</span> has a degree of 2.
<p style="text-align: justify;">
Furthermore the degree in directed graphs (or digraphs) can be split
into the <strong>in degree</strong> which counts the number of edges
pointing <em>into</em> the node and <strong>out degree</strong> which
counts the number of edges emanating <em>from</em> the node. In the
graph generated for Exercise 1.5, the node with index 0 has an <em>out
degree</em> of 3, the node with index 0 has an <em>out degree</em> of 3,
the node with index 3 has an <em>in degree</em> of 3, and the node with
index 1 has a total degree of 4, with an <em>out degree</em> of 2 and an
<em>in degree</em> of 2.
</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> array</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>matrixFromArray <span class="op">=</span>  array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                          [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                          [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                          [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>]])</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>my_graph <span class="op">=</span> nx.from_numpy_matrix(matrixFromArray, create_using<span class="op">=</span>nx.DiGraph)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>my_graphLayout <span class="op">=</span> nx.spring_layout(my_graph, seed<span class="op">=</span><span class="dv">11</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>nx.draw(my_graph, my_graphLayout,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        arrowsize<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-10-7.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>As we discussed in the previous lesson, an edge is set up in a
network matrix in the direction (from) row <span class="math inline">\(\rightarrow\)</span> (to) column. Consider the
following network matrix.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> array</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>mymatrix <span class="op">=</span>  array([[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                   [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>],</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                   [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>],</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                   [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>],</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                   [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]])</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mymatrix)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[0 1 1 0 0]
 [1 0 0 1 1]
 [1 0 0 0 0]
 [0 0 0 0 1]
 [1 0 1 0 0]]</code></pre>
</div>
<p style="text-align: justify;">
The first <em>column</em> tells us which edges reach the first node
(node 0) from another node. Adding the numbers up we find an in degree
of 3 for node 0. If we look at the first <em>row</em> we can see that
there are two edges originating from node 0, giving an out degree of 2.
</p>
<p style="text-align: justify;">
Simple as it is, one would nevertheless like to get it done by the
computer rather than by hand. In NetworkX there are specific functions
to calculate graph qualities such as node degree. To turn the array into
a directed graph and get the degree of all nodes in a network described
by an adjacency matrix we can use the following code. After the matrix
is set up by hand, it is converted into a NetworkX DiGraph object - so
NetworkX will parse the directions of the edges as a directed graph.
</p>
<p>The in degree is calculated, which is the sum over all columns, and
the out degree is calculated, which is the sum over all rows.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mygraph <span class="op">=</span> nx.from_numpy_matrix(mymatrix, create_using<span class="op">=</span>nx.DiGraph)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>mygraph.in_degree</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>InDegreeView({0: 3, 1: 1, 2: 2, 3: 1, 4: 2})</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>mygraph.out_degree</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>OutDegreeView({0: 2, 1: 3, 2: 1, 3: 1, 4: 2})</code></pre>
</div>
<p style="text-align: justify;">
The output is viewed as a list of nodes with each node followed by the
in/out degree. For example, the first node (node 0) has an in degree of
3 (edges from nodes 1, 2 and 4) and out degree 2 (edges to nodes 1 and
2). If the matrix is symmetric, the in degree and the out degree arrays
will be identical. In this case we simply refer to the degree.
</p>
<p style="text-align: justify;">
This graph can also be visualised to confirm the in and out degree of
each node. We have also added a few new customisation options here in
the graph, which you can find and amend using the NetworkX
documentation.
</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mygraphLayout <span class="op">=</span> nx.spectral_layout(mygraph)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>mygraphLabels <span class="op">=</span> {</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'Node 0'</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'Node 1'</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'Node 2'</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'Node 3'</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'Node 4'</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>nx.draw(mygraph, mygraphLayout,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> mygraphLabels,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        node_color <span class="op">=</span> <span class="st">'lavender'</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        node_size <span class="op">=</span> <span class="dv">2000</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        arrowsize<span class="op">=</span><span class="dv">25</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        arrowstyle<span class="op">=</span><span class="st">'-&gt;'</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-14-9.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="do-it-yourself-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-2" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-2"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Using a random seed of 100, set up a <span class="math inline">\(15\times 15\)</span> matrix randomly distributed
integers 0 and 1.</p></li>
<li><p>Turn this matrix into a NetworkX DiGraph object.</p></li>
<li><p>Calculate the <em>in</em> and <em>out degrees</em> for this
graph.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  Q1
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>seed(<span class="dv">100</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>rm_15 <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(nodes, nodes))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rm_15)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[0 0 1 1 1 1 0 0 0 0 0 1 0 0 0]
 [0 1 0 0 1 0 1 0 0 0 1 1 1 0 0]
 [1 0 0 1 1 1 1 1 0 0 1 1 1 1 1]
 [1 1 1 0 1 1 1 0 0 1 1 0 1 0 1]
 [1 1 0 0 1 0 0 1 1 1 0 0 0 0 0]
 [0 1 0 1 0 1 0 0 1 1 0 0 0 1 1]
 [1 1 0 0 1 1 0 0 1 0 1 0 1 0 1]
 [0 1 0 1 1 0 0 1 0 1 1 0 0 0 0]
 [0 0 1 0 1 1 0 1 0 0 0 0 0 0 1]
 [0 1 1 0 0 0 0 1 1 1 1 0 0 1 1]
 [0 0 1 0 0 0 0 1 1 0 1 0 1 0 1]
 [0 1 1 1 1 1 1 1 1 0 0 0 0 1 0]
 [1 0 1 0 0 0 1 0 0 0 1 0 1 1 0]
 [0 1 1 1 0 1 0 0 0 0 0 1 1 0 0]
 [1 0 0 0 1 0 1 0 1 1 0 0 0 1 0]]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  Q2
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>rm_15_Graph <span class="op">=</span> nx.from_numpy_matrix(rm_15, create_using<span class="op">=</span>nx.DiGraph)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  Q3
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" data-bs-parent="#accordionSolution5" aria-labelledby="headingSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing in-degrees</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Index'</span>, <span class="st">'    In Degree'</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind, deg <span class="kw">in</span> rm_15_Graph.in_degree:</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'  '</span>, ind, <span class="st">'       '</span>, deg)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index     In Degree
   0         6
   1         9
   2         8
   3         6
   4         10
   5         8
   6         6
   7         7
   8         7
   9         6
   10         8
   11         4
   12         7
   13         6
   14         7</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Printing out-degrees</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Index'</span>, <span class="st">'   Out Degree'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind, deg <span class="kw">in</span> rm_15_Graph.out_degree:</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'  '</span>, ind, <span class="st">'       '</span>, deg)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Index    Out Degree
   0         5
   1         6
   2         11
   3         10
   4         6
   5         7
   6         8
   7         6
   8         5
   9         8
   10         6
   11         9
   12         6
   13         6
   14         6</code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="degree-distribution"><h2 class="section-heading">Degree distribution<a class="anchor" aria-label="anchor" href="#degree-distribution"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
It is straightforward to look at the degrees of a network with only a
few nodes. However, for large networks with many nodes, the degree will
be an array with as many numbers as there are nodes. This requires a
more convenient way to summarise this information. An often-used
solution is to look at the <em>degree distribution</em>.
</p>
<p>The degree distribution is normally presented as a histogram showing
how many times a given degree was found in that network.</p>
<p>As an example, for a random <span class="math inline">\(10\times
10\)</span> matrix:</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>seed(<span class="dv">4</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>rm_mat <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>rm_net <span class="op">=</span> nx.from_numpy_matrix(rm_mat)</span></code></pre>
</div>
<p>The degree distribution can be plotted using NetworkX and matplotlib,
here plotted simply with the <code>hist</code> plot.</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># xticks, xticklabels as to integers</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>degs <span class="op">=</span> <span class="bu">dict</span>(rm_net.degree()).values()</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>ax.hist(degs, bins<span class="op">=</span><span class="dv">10</span>)<span class="op">;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">"Degree Distribution"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Count"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Degree"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>ax.set_xticks([d <span class="cf">for</span> d <span class="kw">in</span> degs])</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(degs)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-20-11.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
For a more complex example, we can generate a network with 100 nodes and
display its degree distribution (code taken <a href="https://networkx.org/documentation/networkx-2.3/auto_examples/drawing/plot_degree_histogram.html" class="external-link">from
the NetworkX documentation</a>).
</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>probab <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.gnp_random_graph(nodes, probab, seed<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> axes, axis, title</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> collections</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>degree_sequence <span class="op">=</span> <span class="bu">sorted</span>([d <span class="cf">for</span> n, d <span class="kw">in</span> G.degree()], reverse<span class="op">=</span><span class="va">True</span>)  <span class="co"># degree sequence</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>degreeCount <span class="op">=</span> collections.Counter(degree_sequence)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>deg, cnt <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>degreeCount.items())</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>ax.bar(deg, cnt, width<span class="op">=</span><span class="fl">0.80</span>, color<span class="op">=</span><span class="st">"b"</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>title(<span class="st">"Degree Distribution"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Count"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Degree"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>ax.set_xticks([d <span class="cf">for</span> d <span class="kw">in</span> deg])</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(deg)<span class="op">;</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="co"># draw graph in inset</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>axes([<span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>G.subgraph(<span class="bu">sorted</span>(nx.connected_components(G), key<span class="op">=</span><span class="bu">len</span>, reverse<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>])</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(G, seed<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>axis(<span class="st">"off"</span>)</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_nodes(G, pos, node_size<span class="op">=</span><span class="dv">30</span>, node_color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_edges(G, pos)<span class="op">;</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;BarContainer object of 8 artists&gt;
&lt;networkx.classes.graph.Graph object at 0x7f2994feaef0&gt;
(0.0, 1.0, 0.0, 1.0)</code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-22-13.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>This example plots the degree distribution, showing, for example,
that 11 nodes in this network have no edges. You can verify that from
the overlaid graph (isolated red dots).</p>
<p>Note how the degree with highest probability (2) reflects the choice
of edge probability of 2%.</p>
<div id="do-it-yourself-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-3" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-3"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Change the number of nodes to 1000 and check the maximum of the
degree distribution. How does it depend on the number of nodes?</p></li>
<li><p>The second argument in the generation of the graph gives the
probability of edge creation. How do both the appearance of the network
and the degree distribution change?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  Q1
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" data-bs-parent="#accordionSolution6" aria-labelledby="headingSolution6">
<div class="accordion-body">
<p><code>degree_max = probab / nodes</code></p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>probab <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> nx.gnp_random_graph(nodes, probab, seed<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>degree_sequence <span class="op">=</span> <span class="bu">sorted</span>([d <span class="cf">for</span> n, d <span class="kw">in</span> G.degree()], reverse<span class="op">=</span><span class="va">True</span>)  <span class="co"># degree sequence</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>degreeCount <span class="op">=</span> collections.Counter(degree_sequence)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>deg, cnt <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>degreeCount.items())</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>ax.bar(deg, cnt, width<span class="op">=</span><span class="fl">0.80</span>, color<span class="op">=</span><span class="st">"b"</span>)</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>title(<span class="st">"Degree Histogram"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Count"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Degree"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>ax.set_xticks([d <span class="cf">for</span> d <span class="kw">in</span> deg])</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(deg)<span class="op">;</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="co"># draw graph in inset</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>axes([<span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>G.subgraph(<span class="bu">sorted</span>(nx.connected_components(G), key<span class="op">=</span><span class="bu">len</span>, reverse<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>])</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(G, seed<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>axis(<span class="st">"off"</span>)</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_nodes(G, pos, node_size<span class="op">=</span><span class="dv">30</span>, node_color<span class="op">=</span><span class="st">'r'</span>)</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_edges(G, pos)<span class="op">;</span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;BarContainer object of 28 artists&gt;
&lt;networkx.classes.graph.Graph object at 0x7f2992986b90&gt;
(0.0, 1.0, 0.0, 1.0)</code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-23-15.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="accordionSolution7" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution7" aria-expanded="false" aria-controls="collapseSolution7">
  <h4 class="accordion-header" id="headingSolution7">
  Q2
  </h4>
</button>
<div id="collapseSolution7" class="accordion-collapse collapse" data-bs-parent="#accordionSolution7" aria-labelledby="headingSolution7">
<div class="accordion-body">
<blockquote>
<p>The edge probability determines how connected a graph is. The higher
the probability, the more connected. With a probability of 1, a fully
connected graph is created. The most frequenc degree is given by the
above formula.</p>
</blockquote>
</div>
</div>
</div>
</div>
</section><section id="other-graph-properties"><h2 class="section-heading">Other Graph Properties<a class="anchor" aria-label="anchor" href="#other-graph-properties"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="clustering-coefficient">
<strong>Clustering coefficient</strong><a class="anchor" aria-label="anchor" href="#clustering-coefficient"></a>
</h3>
<p style="text-align: justify;">
As an example of a more complex quantitative measure, we take the
clustering coefficient. We will look at its formula and discuss extreme
cases to understand what useful information the measure is supposed to
convey. We then practice the use of creating test matrices and do
calculations of clustering coefficients of the corresponding networks.
</p>
<div id="callout1" class="callout callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Callout<a class="anchor" aria-label="anchor" href="#callout1"></a>
</h3>
<div class="callout-content">
<p>##Definition</p>
<p>The clustering coefficient is defined by the formula:</p>
<p><span class="math inline">\(C_u = \frac{ 2e }{ k(k-1) }\)</span></p>
</div>
</div>
</div>
<p style="text-align: justify;">
The <strong>clustering coefficient</strong>, here denoted by <span class="math inline">\(C_u\)</span>, is a number that is calculated for a
single node, <span class="math inline">\(u\)</span>. For the calculation
one needs to know the degree of the node, <span class="math inline">\(k\)</span>. The degree represents the number of
direct connections of the node. Nodes connected by an edge are referred
to as nearest neighbours, or simply neighbours. Therefore, the degree is
also equal to the number of neighbours. Finally, <span class="math inline">\(e\)</span> is the number of edges (connections)
between the neighbours of <span class="math inline">\(u\)</span>.
</p>
<p style="text-align: justify;">
The formula is derived as the number of edges between the neighbours
divided by the maximally possible number of connections. The maximal
number of possible connections of <span class="math inline">\(k\)</span>
neighbours is <span class="math inline">\(\frac{ k(k-1)}{2}\)</span>.
There are <span class="math inline">\(k\times k\)</span> elements but if
we leave out self-connections it becomes <span class="math inline">\(k\times (k-1)\)</span>. As each edge is included
twice (forward and backward) division by 2 gives the number of
undirected connections.
</p>
<p style="text-align: justify;">
This yields some important properties: if there is no connection between
any of the neighbours, then <span class="math inline">\(e=0\)</span> and
<span class="math inline">\(C_u = 0\)</span>. If all neighbours are
maximally connected (each node connected to every other node), then
<span class="math inline">\(e=\frac{ k(k-1)}{ 2 }\)</span> and <span class="math inline">\(C_u = 1\)</span>. The clustering coefficient
therefore tells us the extent to which neighbours of a node are
connected among themselves. This definition is valid for undirected
networks with no self-connections.
</p>
<p>We can use random test graphs, as we made earlier, to explore
clustering coefficients in NetworkX. Here we’ll make a 10 by 10 random
graph, setting a seed so it’s reproducible.</p>
<p>To avoid any self-connections, we put the diagonal of the matrix
equal to zero.</p>
<div class="codewrapper sourceCode" id="cb37">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> fill_diagonal</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>seed_number <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>nodes <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>seed(seed_number)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>rm_graph <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(nodes, nodes))</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>fill_diagonal(rm_graph, <span class="dv">0</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>myRandom <span class="op">=</span> nx.from_numpy_matrix(rm_graph)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>nx.draw(myRandom, node_color<span class="op">=</span><span class="st">'y'</span>, with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-24-17.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
We can now use NetworkX to learn more about this graph. To print a list
of the clustering coefficient for each node (calculated with the above
formula), we use the function <span class="math inline">\(clustering\)</span>.
</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nx.clustering(myRandom))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{0: 0.5714285714285714, 1: 0.5238095238095238, 2: 0.8, 3: 0.6666666666666666, 4: 0.8, 5: 0.6, 6: 0.8095238095238095, 7: 0.7142857142857143, 8: 0.6071428571428571, 9: 0.8095238095238095}</code></pre>
</div>
<p>With slightly nicer formatting:</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind, cc <span class="kw">in</span> <span class="bu">dict</span>(nx.clustering(myRandom)).items():</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(ind, <span class="st">'   '</span>, cc)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0     0.5714285714285714
1     0.5238095238095238
2     0.8
3     0.6666666666666666
4     0.8
5     0.6
6     0.8095238095238095
7     0.7142857142857143
8     0.6071428571428571
9     0.8095238095238095</code></pre>
</div>
<p>To extract the clustering coefficients from the result as a Python
list:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> around</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>clustcoeffs <span class="op">=</span> <span class="bu">list</span>(<span class="bu">dict</span>(nx.clustering(myRandom)).values())</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(around(clustcoeffs, <span class="dv">2</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[0.57 0.52 0.8  0.67 0.8  0.6  0.81 0.71 0.61 0.81]</code></pre>
</div>
<p>You can also obtain the average clustering coefficient across your
graph directly from NetworkX:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nx.average_clustering(myRandom))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">0.6902380952380953</span></span></code></pre>
</div>
<p>The number shows that in this graph there is a comparatively high
(more than 50%) probability of the neighbours of a node to be connected
among themselves.</p>
</div>
<div class="section level3">
<h3 id="path-length">
<strong>Path length</strong><a class="anchor" aria-label="anchor" href="#path-length"></a>
</h3>
<p style="text-align: justify;">
Simply put, the <strong>path length</strong> refers to the distance
between two nodes in a graph, calculated as the number of edges to get
from one to the other. More specific information about a graph can be
found by measures that build on the path length, such as the
<em>shortest path length</em>, <em>average shortest path length</em>,
and the <em>shortest path length from node to all reachable nodes</em>.
</p>
<p>For illustration, here is how we can find out the shortest path of
our graph <span class="math inline">\(myRandom\)</span> from node 0 to
node 1. The output is the sequence of nodes along this shortest
path.</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nx.shortest_path(myRandom, source<span class="op">=</span><span class="dv">0</span>, target<span class="op">=</span><span class="dv">1</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[0, 2, 1]</code></pre>
</div>
<p style="text-align: justify;">
The shortest path from node 0 to node 1 is via node with index 2. This
shows that the shortest path between these two nodes only passes through
<em>one other node</em>. There may be other paths of the same length,
but none which are shorter. If we want to know <em>all possible</em>
shortest paths between a pair of nodes, we can do that too.
</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>my_shortest_paths <span class="op">=</span> nx.all_shortest_paths(myRandom, source<span class="op">=</span><span class="dv">0</span>, target<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> my_shortest_paths:</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(path)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[0, 2, 1]
[0, 3, 1]
[0, 4, 1]
[0, 6, 1]
[0, 9, 1]
[0, 5, 1]</code></pre>
</div>
<p>There are six possibilities to get from node 0 to node 1 via one
intermediate node.</p>
<p>As a single summary quantity of a network, we can find the
<em>average shortest path length</em>:</p>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">round</span>(nx.average_shortest_path_length(myRandom), <span class="dv">2</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1.29</span></span></code></pre>
</div>
<div id="do-it-yourself-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-4" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-4"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Using the <span class="math inline">\(15\times 15\)</span> matrix
you created in Exercise 2.3, calculate the average shortest path
length.</p></li>
<li><p>Using the same matrix, print the shortest path length between
nodes 2 and 8.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution8" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution8" aria-expanded="false" aria-controls="collapseSolution8">
  <h4 class="accordion-header" id="headingSolution8">
  Q1
  </h4>
</button>
<div id="collapseSolution8" class="accordion-collapse collapse" data-bs-parent="#accordionSolution8" aria-labelledby="headingSolution8">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb52">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">round</span>(nx.average_shortest_path_length(rm_15_Graph), <span class="dv">2</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1.54</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution9" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution9" aria-expanded="false" aria-controls="collapseSolution9">
  <h4 class="accordion-header" id="headingSolution9">
  Q2
  </h4>
</button>
<div id="collapseSolution9" class="accordion-collapse collapse" data-bs-parent="#accordionSolution9" aria-labelledby="headingSolution9">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb54">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>my_shortest_paths <span class="op">=</span> nx.all_shortest_paths(rm_15_Graph, source<span class="op">=</span><span class="dv">2</span>, target<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> my_shortest_paths:</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(path)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[2, 4, 8]
[2, 5, 8]
[2, 6, 8]
[2, 10, 8]
[2, 11, 8]
[2, 14, 8]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="centrality">
<strong>Centrality</strong><a class="anchor" aria-label="anchor" href="#centrality"></a>
</h3>
<p style="text-align: justify;">
<em>Centrality</em> can be used to determine the most <em>important</em>
node or nodes in a graph. In a network such as a protein-protein
interaction network, this would be the protein which interacts with most
other proteins in the system. The centrality of each node in a network
is calculated as the fraction of nodes in the graph with which is
connects.
</p>
<div class="codewrapper sourceCode" id="cb56">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>my_centralities <span class="op">=</span> nx.degree_centrality(myRandom)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> index, centr <span class="kw">in</span> <span class="bu">dict</span>(my_centralities).items():</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(index, <span class="st">'  '</span>, <span class="bu">round</span>(centr, <span class="dv">2</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0    0.78
1    0.78
2    0.67
3    0.44
4    0.67
5    0.56
6    0.78
7    0.78
8    0.89
9    0.78</code></pre>
</div>
<p>This produces a dictionary of nodes followed by the centrality value.
In this graph, node 8 is the most ‘important’ node (according to this
definition).</p>
</div>
</section><section id="analysing-a-biological-network"><h2 class="section-heading">Analysing a biological network<a class="anchor" aria-label="anchor" href="#analysing-a-biological-network"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
<em>Caenorhabditis elegans</em> (<em>C. elegans</em>) is a nematode used
as model organism to study developmental biology, and specifically
neuronal development. It is one of the simplest organisms with a nervous
system, which makes it particularly suited for this research. The
majority of <em>C. elegans</em> individuals are hermaphrodites. The
developmental trajectory of each somatic cell (in hermaphrodites 959, in
males 1031) has been identified, and is generally consistent between
worms. The complete connectome (neuronal map) has been published,
originally by White, Southgate, Thomson, and Brenner in 1986, and
continues to be researched. Here, we take nodes to represent neurons and
edges to represent synapses.
</p>
<div class="section level3">
<h3 id="getting-a-network-matrix-from-dynamic-connectome-lab">
<strong>Getting a network matrix from Dynamic Connectome
lab</strong><a class="anchor" aria-label="anchor" href="#getting-a-network-matrix-from-dynamic-connectome-lab"></a>
</h3>
<p style="text-align: justify;">
In this final section we want to benefit from network information that
is stored in a freely available database. There are a number of
databases that include information about interactions. In the context of
biochemical reaction networks, two prominent examples are the (<a href="http://www.genome.jp/kegg/pathway.html/" class="external-link">KEGG database</a>) and
the (<a href="http://www.reactome.org/" class="external-link">Reactome database</a>). In the
previous lesson, we have used an example from the <a href="https://string-db.org" class="external-link">STRING database</a> which contained data
about protein-protein interactions (PPI). Other examples are the <a href="https://thebiogrid.org" class="external-link">BioGrid Database of Protein, Genetic and
Chemical Interactions</a> and the <a href="https://www.ebi.ac.uk/legacy-intact/" class="external-link">IntAct Molecular Interaction
Database</a>.
</p>
<p style="text-align: justify;">
Some researchers also make their data freely available upon publication.
In this section we are going to use some simplified data from the <a href="https://www.dynamic-connectome.org/" class="external-link">Dynamic Connectome lab</a> on
the neuronal networks of <em>C. elegans</em>. For simplicity, these data
have been edited such that only the first 50 of the 131 neurons are
included. The Python Pandas library is used to import this data. First,
we import the adjacency matrix showing how these neurons connect to each
other, and a file containing the name of each neuron.
</p>
<p style="text-align: justify;">
Then, we convert the adjacency matrix to the Numpy format, and the
labels into a dictionary. We then save the labels (each neuron has a
name!) in the NetworkX node label format, and convert the adjacency
matrix into the NetworkX format. Finally, we give the graph the layout
<span class="math inline">\(random\)</span>, and draw it.
</p>
<div class="codewrapper sourceCode" id="cb58">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>neurons     <span class="op">=</span> read_csv(<span class="st">'data/celegans131matrix_50.csv'</span>, header <span class="op">=</span> <span class="va">None</span>, dtype <span class="op">=</span> <span class="st">"float64"</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>neuronNames <span class="op">=</span> read_csv(<span class="st">'data/celegans131labels_50.csv'</span>, header <span class="op">=</span> <span class="va">None</span>)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>neurons     <span class="op">=</span> neurons.to_numpy()</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>neuronNames <span class="op">=</span> neuronNames.to_dict()</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>neuronLabels <span class="op">=</span> neuronNames[<span class="dv">0</span>]</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>neuronGraph  <span class="op">=</span> nx.from_numpy_matrix(neurons)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>neuronLayout <span class="op">=</span> nx.random_layout(neuronGraph)</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>nx.draw(neuronGraph, neuronLayout,</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1500</span>,</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'turquoise'</span>,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> neuronLabels</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>       )</span></code></pre>
</div>
<p>We can examine this network similar to the way we did for our
earlier, smaller networks.</p>
<p>For instance, we can confirm the (reduced) number of nodes.</p>
<div class="codewrapper sourceCode" id="cb59">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>neuronGraph.number_of_nodes()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">50</span></span></code></pre>
</div>
<p style="text-align: justify;">
Using the techniques we introduced above, we can interrogate various
aspects of this real-world network, such as finding the node with the
greatest centrality, assess the average path length, and find out the
clustering coefficients.
</p>
</div>
</section><section id="exercises"><h2 class="section-heading">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h2>
<hr class="half-width">
<div id="assignment" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="assignment" class="callout-inner">
<h3 class="callout-title">Assignment<a class="anchor" aria-label="anchor" href="#assignment"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Compute the number of edges in the above <em>C. elegans</em>
neuron network.</p></li>
<li><p>Compute the average clustering coefficient across this
network.</p></li>
<li><p>Calculate the centrality of each node.</p></li>
<li><p>Find the average shortest path length.</p></li>
<li><p>Find the shortest path length between neurons 4 and 44.</p></li>
<li><p>Plot the degree distribution of the network with inserted network
graph.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution10" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution10" aria-expanded="false" aria-controls="collapseSolution10">
  <h4 class="accordion-header" id="headingSolution10">
  Please check these solutions only after submitting the assignments.
  </h4>
</button>
<div id="collapseSolution10" class="accordion-collapse collapse" data-bs-parent="#accordionSolution10" aria-labelledby="headingSolution10">
<div class="section level3 accordion-body">
<h3 id="q1-3">Q1<a class="anchor" aria-label="anchor" href="#q1-3"></a>
</h3>
<div class="codewrapper sourceCode" id="cb61">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of Edges'</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(neuronGraph.number_of_edges())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Number of Edges
186</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution11" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution11" aria-expanded="false" aria-controls="collapseSolution11">
  <h4 class="accordion-header" id="headingSolution11">
  Q2
  </h4>
</button>
<div id="collapseSolution11" class="accordion-collapse collapse" data-bs-parent="#accordionSolution11" aria-labelledby="headingSolution11">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb63">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Clustering Coefficients'</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nx.average_clustering(neuronGraph))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Clustering Coefficients
0.3174194694194694</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution12" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution12" aria-expanded="false" aria-controls="collapseSolution12">
  <h4 class="accordion-header" id="headingSolution12">
  Q3
  </h4>
</button>
<div id="collapseSolution12" class="accordion-collapse collapse" data-bs-parent="#accordionSolution12" aria-labelledby="headingSolution12">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb65">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Degree Centrality'</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nx.degree_centrality(neuronGraph))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Degree Centrality
{0: 0.08163265306122448, 1: 0.14285714285714285, 2: 0.26530612244897955, 3: 0.24489795918367346, 4: 0.061224489795918366, 5: 0.061224489795918366, 6: 0.2040816326530612, 7: 0.22448979591836732, 8: 0.32653061224489793, 9: 0.1020408163265306, 10: 0.1020408163265306, 11: 0.16326530612244897, 12: 0.14285714285714285, 13: 0.061224489795918366, 14: 0.22448979591836732, 15: 0.24489795918367346, 16: 0.08163265306122448, 17: 0.08163265306122448, 18: 0.16326530612244897, 19: 0.2040816326530612, 20: 0.12244897959183673, 21: 0.1020408163265306, 22: 0.02040816326530612, 23: 0.02040816326530612, 24: 0.1020408163265306, 25: 0.08163265306122448, 26: 0.1020408163265306, 27: 0.08163265306122448, 28: 0.22448979591836732, 29: 0.24489795918367346, 30: 0.2857142857142857, 31: 0.2857142857142857, 32: 0.22448979591836732, 33: 0.24489795918367346, 34: 0.2040816326530612, 35: 0.24489795918367346, 36: 0.14285714285714285, 37: 0.12244897959183673, 38: 0.18367346938775508, 39: 0.2040816326530612, 40: 0.061224489795918366, 41: 0.1020408163265306, 42: 0.16326530612244897, 43: 0.12244897959183673, 44: 0.12244897959183673, 45: 0.18367346938775508, 46: 0.18367346938775508, 47: 0.1020408163265306, 48: 0.1020408163265306, 49: 0.02040816326530612}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution13" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution13" aria-expanded="false" aria-controls="collapseSolution13">
  <h4 class="accordion-header" id="headingSolution13">
  Q4
  </h4>
</button>
<div id="collapseSolution13" class="accordion-collapse collapse" data-bs-parent="#accordionSolution13" aria-labelledby="headingSolution13">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb67">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Average shortest path length'</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nx.average_shortest_path_length(neuronGraph))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Average shortest path length
2.3518367346938778</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution14" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution14" aria-expanded="false" aria-controls="collapseSolution14">
  <h4 class="accordion-header" id="headingSolution14">
  Q5
  </h4>
</button>
<div id="collapseSolution14" class="accordion-collapse collapse" data-bs-parent="#accordionSolution14" aria-labelledby="headingSolution14">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb69">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Shortest path length between N4 and N44'</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>([p <span class="cf">for</span> p <span class="kw">in</span> nx.all_shortest_paths(neuronGraph, source<span class="op">=</span><span class="dv">4</span>, target<span class="op">=</span><span class="dv">44</span>)])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Shortest path length between N4 and N44
[[4, 15, 42, 44]]</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="accordionSolution15" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution15" aria-expanded="false" aria-controls="collapseSolution15">
  <h4 class="accordion-header" id="headingSolution15">
  Q6
  </h4>
</button>
<div id="collapseSolution15" class="accordion-collapse collapse" data-bs-parent="#accordionSolution15" aria-labelledby="headingSolution15">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb71">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>degree_sequence <span class="op">=</span> <span class="bu">sorted</span>([d <span class="cf">for</span> n, d <span class="kw">in</span> neuronGraph.degree()], reverse<span class="op">=</span><span class="va">True</span>)  <span class="co"># degree sequence</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>degreeCount <span class="op">=</span> collections.Counter(degree_sequence)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>deg, cnt <span class="op">=</span> <span class="bu">zip</span>(<span class="op">*</span>degreeCount.items())</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots()</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>ax.bar(deg, cnt, width<span class="op">=</span><span class="fl">0.80</span>, color<span class="op">=</span><span class="st">"b"</span>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>title(<span class="st">"Degree Distribution"</span>, fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Count"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Degree"</span>, fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>ax.set_xticks([d <span class="cf">for</span> d <span class="kw">in</span> deg])</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(deg)<span class="op">;</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="co"># draw graph in inset</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>axes([<span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>])</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>neuronGraph.subgraph(<span class="bu">sorted</span>(nx.connected_components(neuronGraph), key<span class="op">=</span><span class="bu">len</span>, reverse<span class="op">=</span><span class="va">True</span>)[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.spring_layout(neuronGraph, seed<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>axis(<span class="st">"off"</span>)</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_nodes(neuronGraph, pos, node_size<span class="op">=</span><span class="dv">30</span>, node_color<span class="op">=</span><span class="st">'r'</span>)<span class="op">;</span></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx_edges(neuronGraph, pos)<span class="op">;</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;BarContainer object of 14 artists&gt;
(0.0, 1.0, 0.0, 1.0)</code></pre>
</div>
<figure><img src="../fig/02-networks_2-rendered-unnamed-chunk-42-19.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The function <code>randint</code> creates matrices with randomly
assigned integers which are represented as edges.</li>
<li>NetworkX can produce interesting graphs like: <code>Petersen</code>,
<code>lobster</code> and <code>caterpillar</code> graphs.</li>
<li>In a symmetric matrix, the <code>in degree</code> and the
<code>out degree</code> arrays are identical.</li>
<li>Large networks can be quantified using
e.g. <code>the degree distribution</code>.</li>
<li>Some of the key graph properties include the clustering coefficient,
path length, and centrality.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></section><section id="aio-03-networks_3"><p>Content from <a href="03-networks_3.html">Networks - Applications</a></p>
<hr>
<p> Last updated on 2023-07-11 | 
        
        <a href="https://github.com/LearnToDiscover/Networks.git/edit/main/episodes/03-networks_3.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time <i aria-hidden="true" data-feather="clock"></i> 120 minutes </p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right"> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<p><a href="../03-networks_3.ipynb"><strong>Download Chapter notebook
(ipynb)</strong></a></p>
<p><a href="https://docs.google.com/forms/d/e/1FAIpQLSdr0capF7jloJhPH3Pki1B3LZoKOG16poOpuVJ7SL2LkwLHQA/viewform?pli=1" class="external-link"><span style="color: rgb(255, 0, 0);"><strong>Mandatory Lesson Feedback
Survey</strong></span></a></p>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What ways are there to import data into NetworkX?</li>
<li>What are the common file import error?</li>
<li>How to troubleshoot the import errors?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Reviewing data import</li>
<li>Understanding troubleshooting of common errors in data import</li>
<li>Handling a bipartite network</li>
<li>Applying network concepts to real-world datasets</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="prerequisites" class="callout prereq">
<div class="callout-square">
<i class="callout-icon" data-feather="check"></i>
</div>
<div id="prerequisites" class="callout-inner">
<h3 class="callout-title">Prerequisites<a class="anchor" aria-label="anchor" href="#prerequisites"></a>
</h3>
<div class="callout-content">
<ul>
<li><a href="01-networks_1.html">Networks - Part 1</a></li>
<li><a href="02-networks_2.html">Networks - Part 2</a></li>
</ul>
</div>
</div>
</div>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> networkx <span class="im">as</span> nx</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pandas <span class="im">import</span> read_csv</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> mean, fill_diagonal</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy.random <span class="im">import</span> randint</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pyplot <span class="im">import</span> subplots, show</span></code></pre>
</div>
<section id="importing-data-into-networkx"><h2 class="section-heading">Importing data into NetworkX<a class="anchor" aria-label="anchor" href="#importing-data-into-networkx"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
In the previous lessons we have looked at the basics of NetworkX,
created some networks, analysed various network properties, and
practised these techniques with the pre-prepared <em>C. elegans</em>
dataset. If you want to use NetworkX with data of your own, you’ll need
to import your data in a compatible way. Specifically, you need to be
able to import data from different original data formats.
</p>
<div class="section level3">
<h3 id="csv-format">
<strong>CSV Format</strong><a class="anchor" aria-label="anchor" href="#csv-format"></a>
</h3>
<p><code>.csv</code> indicates a very common file format, <a href="https://en.wikipedia.org/wiki/Comma-separated_values" class="external-link">comma
separated values</a>. We used it in the previous lesson to import the
<em>C. elegans</em> neuronal network.</p>
<p style="text-align: justify;">
The network data ‘celegans131matrix_50.csv’ is simply a large adjacency
matrix of 0s and 1s, with no further information. The
‘celegans131labels_50.csv’ file contains the list of neuron names, which
we used to label the nodes. We’ll have a look in more detail at how this
import works. We use Pandas functions as a simple way to import a CSV
file. (There are, of course, other ways.)
</p>
<p>Here is the import of the data for the first 50 neurons.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>neurons<span class="op">=</span>read_csv(<span class="st">'data/celegans131matrix_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>, dtype <span class="op">=</span> <span class="st">"int"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>neurons<span class="op">=</span>neurons.to_numpy()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(neurons))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">50</span></span></code></pre>
</div>
<p style="text-align: justify;">
We import the CSV network file as before. We specify with a keyword
argument that there is no header, otherwise the first line in the file
will be assumed to be a header and not parsed (handled) in the same way
as the rest of the data. We also specify that the adjacency matrix is of
data type <code>int</code>. (This does not necessarily have to be the
case, see the Microbiome network below.) We then convert the
<code>neurons</code> dataframe to a Numpy array. The
<code>neuron_Names</code> can be imported in a similar way. They will
need to be converted from a dataframe to a dictionary:
</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>neuron_Names <span class="op">=</span> read_csv(<span class="st">'data/celegans131labels_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>neuronNames <span class="op">=</span> neuron_Names.to_dict()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>neuronLabels <span class="op">=</span> neuronNames[<span class="dv">0</span>]</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(neuronLabels)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{0: 'ADFL', 1: 'ADFR', 2: 'ADLL', 3: 'ADLR', 4: 'AFDL', 5: 'AFDR', 6: 'AIAL', 7: 'AIAR', 8: 'AIBR', 9: 'AINL', 10: 'AINR', 11: 'AIZL', 12: 'AIZR', 13: 'ALA', 14: 'ASEL', 15: 'ASER', 16: 'ASGL', 17: 'ASGR', 18: 'ASHL', 19: 'ASHR', 20: 'ASIL', 21: 'ASIR', 22: 'ASJL', 23: 'ASJR', 24: 'ASKL', 25: 'ASKR', 26: 'AUAL', 27: 'AUAR', 28: 'AVAL', 29: 'AVAR', 30: 'AVBL', 31: 'AVBR', 32: 'AVDL', 33: 'AVDR', 34: 'AVEL', 35: 'AVER', 36: 'AVHL', 37: 'AVHR', 38: 'AVJL', 39: 'AVJR', 40: 'AVL', 41: 'AWAL', 42: 'AWAR', 43: 'AWBL', 44: 'AWBR', 45: 'AWCL', 46: 'AWCR', 47: 'BAGL', 48: 'BAGR', 49: 'CEPDL'}</code></pre>
</div>
<p style="text-align: justify;">
Dictionaries associate keys with values. You may remember we previously
created a dictionary to assign labels to nodes. Here we convert the
<code>neuron_Names</code> dataframe into a dictionary: the neuron (node)
indices are the keys and the corresponding neuron (node) names are the
values. As the function <code>to_dict</code> wraps the dictionary within
a dictionary, we obtain the plain labels dictionary by referring to
index ‘0’.
</p>
<p>Now we can create a graph, specify a layout, and plot the
network.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>neuronGraph <span class="op">=</span> nx.from_numpy_matrix(neurons)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>neuronLayout <span class="op">=</span> nx.random_layout(neuronGraph, seed<span class="op">=</span><span class="dv">123</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>nx.draw_networkx(neuronGraph, neuronLayout,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> neuronLabels)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
In this particular case, we also have other metadata that can be used
for visualisation and analysis. In our case, we have the file
‘celegans131positions_50.csv’ - which contains information on how the
nodes relate to each other in 2-D space. We can include this information
to replace the layout.
</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>neuronPos <span class="op">=</span> read_csv(<span class="st">'data/celegans131positions_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>neuronPositions <span class="op">=</span> neuronPos.values</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>nx.draw(neuronGraph, neuronPositions,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> neuronLabels)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-5-3.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The two BAG nodes to the right of the display are the (right and
left) <a href="https://www.wormatlas.org/neurons/Individual%20Neurons/BAGframeset.html" class="external-link">sensory
neurons used to monitor oxygen and carbon dioxide</a>.</p>
<div id="do-it-yourself" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself"></a>
</h3>
<div class="callout-content">
<p>Find the node indices of the sensory neurons named ‘BAGL’ and
‘BAGR’.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ind, name <span class="kw">in</span> <span class="bu">enumerate</span>(neuronLabels.values()):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'BAG'</span> <span class="kw">in</span> name:</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(ind, neuronLabels[ind])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>47 BAGL
48 BAGR</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="networks-repository-list-of-edges">
<strong>Networks Repository: List of Edges</strong><a class="anchor" aria-label="anchor" href="#networks-repository-list-of-edges"></a>
</h3>
<p style="text-align: justify;">
Network files in the <a href="http://networkrepository.com/index.php" class="external-link">Network Repository</a> are
sourced from publications and provided in the ‘.edges’ format. These are
plain text files. Let’s have a look at the network of a mouse visual
cortex. You can find this at <a href="http://networkrepository.com/bn-mouse-visual-cortex-1.php" class="external-link">MOUSE-VISUAL-CORTEX-1</a>.
You can either download the zip file from the database or use the file
provided for this Lesson.
</p>
<p style="text-align: justify;">
Place the file ‘bn-mouse_visual-cortex_1.edges’ in your working
directory. It can be helpful to first open it in any text-editor to see
what the data look like. In this case, it is a list of two numbers per
row, separated by a space. This is the list of (directed) edges. The
first number indicating ‘from’, the second ‘to’. Nodes are not given
explicitly but will be inferred from the indices.
</p>
<p>Being a list of edges, we can import it into NetworkX as an
<em>edgelist</em>, specifying that the nodes are given as integers. The
result is a standard graph object which we can plot using
<code>draw</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>MouseCortex <span class="op">=</span> nx.read_edgelist(<span class="st">"data/bn-mouse_visual-cortex_1.edges"</span>, nodetype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>MouseCortexLayout <span class="op">=</span> nx.random_layout(MouseCortex, seed<span class="op">=</span><span class="dv">111</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>nx.draw(MouseCortex, MouseCortexLayout,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'r'</span>,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-7-5.png" width="672" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>To interpret the network, you can check it against the source, <a href="http://networkrepository.com/bn-mouse-visual-cortex-1.php" class="external-link">MOUSE-VISUAL-CORTEX-1</a>.</p>
<div id="do-it-yourself-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-1" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-1"></a>
</h3>
<div class="callout-content">
<p>Network Repository provides some summary data on all their networks.
Obtain the (i) number of nodes, (ii) number of edges, and (iii) average
clustering coefficient and compare it to the data in <a href="https://networkrepository.com/bn-mouse-visual-cortex-1.php" class="external-link">their
network summary</a>.</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of nodes:'</span>, <span class="bu">len</span>(MouseCortex))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of edges:'</span>, <span class="bu">len</span>(MouseCortex.edges))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Average clustering coefficient:'</span>, mean(<span class="bu">list</span>(nx.clustering(MouseCortex).values())))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Number of nodes: 29

Number of edges: 44

Average clustering coefficient: 0.04942528735632184</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="json-format">
<strong>JSON Format</strong><a class="anchor" aria-label="anchor" href="#json-format"></a>
</h3>
<p style="text-align: justify;">
<a href="https://en.wikipedia.org/wiki/JSON" class="external-link">JSON (JavaScript Object
Notation)</a> is an open standard file format which is language
independent and widely used. Here is an example code to import and
display the network that contains <a href="http://konect.cc/networks/moreno_lesmis/" class="external-link">co-occurances of
characters in Victor Hugo’s novel ‘Les Misérables’</a>.
</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'data/miserables.json'</span>, <span class="st">'r'</span>) <span class="im">as</span> myfile:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    data<span class="op">=</span>myfile.read()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>miserables <span class="op">=</span> json.loads(data)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>miserablesNetwork <span class="op">=</span> nx.json_graph.node_link_graph(miserables)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>miserablesNetworkLayout <span class="op">=</span> nx.circular_layout(miserablesNetwork)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">12</span>))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>nx.draw(miserablesNetwork, miserablesNetworkLayout,</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-9-7.png" width="1152" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>As you can see, the ‘data’ variable contains the character names as
node names.</p>
<p>If you are curious, open the file with a text editor and check the
entries.</p>
<p>E.g. our file starts like this:</p>
<pre><code>{

  "nodes": [

    {"id": "Myriel", "group": 1},</code></pre>
<p style="text-align: justify;">
As you can see, the style with curly brackets and colons immediately
suggests the use of associative arrays (dictionary) once the data are
within Python. The function <code>node_link_graph</code> provides an
interface to handle the data as a NetworkX graph.
</p>
<p style="text-align: justify;">
There are many other files formats that contain network data. For a list
of NetworkX functions that allow import from and export to other file
formats, see <a href="http://localhost:8888/lab/tree/Dropbox/Lessons_NetworkX" class="external-link">Reading
and writing graphs</a>.
</p>
</div>
</section><section id="networkx-troubleshooting"><h2 class="section-heading">NetworkX troubleshooting<a class="anchor" aria-label="anchor" href="#networkx-troubleshooting"></a>
</h2>
<hr class="half-width">
<p>There are many errors that may occur in the context of dealing with
network data. We exemplify some common problems, to help find out how to
diagnose and solve them.</p>
<div class="section level3">
<h3 id="filenotfounderror">
<strong>FileNotFoundError</strong><a class="anchor" aria-label="anchor" href="#filenotfounderror"></a>
</h3>
<p>Here we try to import a CSV file which contains an adjacency matrix.
We have checked that the file is present in the working directory.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>neurons <span class="op">=</span> read_csv(<span class="st">'data/celegans131mtrix_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="st">"float64"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: FileNotFoundError: [Errno 2] No such file or directory: 'data/celegans131mtrix_50.csv'</code></pre>
</div>
<div id="do-it-yourself-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-2" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-2"></a>
</h3>
<div class="callout-content">
<p>What has gone wrong, and what is the solution?</p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>You’ll see this error if something has gone wrong in the way you’ve
instructed Python to find your file. This may be that you’ve mis-typed
the file name, or the file isn’t in your working directory. Here, the
file is present in the working directory, but there’s a typo in the file
name.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>neurons <span class="op">=</span> read_csv(<span class="st">'data/celegans131matrix_50.csv'</span>, header<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="st">'int'</span>)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="keyerror">
<strong>KeyError</strong><a class="anchor" aria-label="anchor" href="#keyerror"></a>
</h3>
<p>Here we generate a random adjacency matrix, specify how it should be
plotted, and try to visualise it.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rm <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>thisgraph <span class="op">=</span> nx.from_numpy_matrix(rm)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>thisgraphLayout <span class="op">=</span> nx.spiral_layout(thisgraph)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>thisgraphLabels <span class="op">=</span> {</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'D'</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'E'</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>: <span class="st">'F'</span>,</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>nx.draw(thisgraph, thisgraphLayout,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>thisgraphLabels)</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code><span><span class="va">Error</span><span class="op">:</span> <span class="va">KeyError</span><span class="op">:</span> <span class="fl">5</span></span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-12-9.png" width="1152" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="do-it-yourself-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-3" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-3"></a>
</h3>
<div class="callout-content">
<p>Why does the call of <code>draw</code> throw an error, and what is
the solution?</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<p>If you look at the error message, it first flags <strong>5:
‘F’,</strong>, and ends with an error about labels. We’ve included too
many node labels: 6 labels for five nodes. This is easily corrected by
taking one label out.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>rm <span class="op">=</span> randint(<span class="dv">0</span>, <span class="dv">2</span>, size<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">5</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>thisgraph <span class="op">=</span> nx.from_numpy_matrix(rm)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>thisgraphLayout <span class="op">=</span> nx.spiral_layout(thisgraph)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>thisgraphLabels <span class="op">=</span> {</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>: <span class="st">'A'</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>: <span class="st">'B'</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>: <span class="st">'C'</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>: <span class="st">'D'</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="dv">4</span>: <span class="st">'E'</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>nx.draw(thisgraph, thisgraphLayout,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'tomato'</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>thisgraphLabels)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-13-11.png" width="1152" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="graph-is-not-bipartite">
<strong>Graph is not bipartite</strong><a class="anchor" aria-label="anchor" href="#graph-is-not-bipartite"></a>
</h3>
<p>Here we generate a bipartite graph and try to plot it.</p>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>thisBipartite <span class="op">=</span> nx.Graph()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add nodes with the node attribute "bipartite"</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>thisBipartite.add_nodes_from([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span>], bipartite<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>thisBipartite.add_nodes_from([<span class="st">'m'</span>, <span class="st">'n'</span>, <span class="st">'o'</span>, <span class="st">'p'</span>, <span class="st">'q'</span>, <span class="st">'r'</span>], bipartite<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add edges only between nodes of opposite node sets</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>thisBipartite.add_edges_from([(<span class="st">'a'</span>, <span class="st">'m'</span>), (<span class="st">'a'</span>, <span class="st">'n'</span>),</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'b'</span>, <span class="st">'n'</span>), (<span class="st">'b'</span>, <span class="st">'o'</span>),</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'c'</span>, <span class="st">'o'</span>), (<span class="st">'d'</span>, <span class="st">'m'</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'a'</span>, <span class="st">'p'</span>), (<span class="st">'a'</span>, <span class="st">'d'</span>),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'f'</span>, <span class="st">'p'</span>), (<span class="st">'d'</span>, <span class="st">'r'</span>),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'a'</span>, <span class="st">'q'</span>), (<span class="st">'e'</span>, <span class="st">'n'</span>)])</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>nx.is_connected(thisBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>basegroup <span class="op">=</span> nx.bipartite.sets(thisBipartite)[<span class="dv">0</span>]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>bipartiteLayout <span class="op">=</span> nx.bipartite_layout(thisBipartite, basegroup)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>nx.draw(thisBipartite, bipartiteLayout,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">2000</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: networkx.exception.NetworkXError: Graph is not bipartite.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: NameError: name 'basegroup' is not defined</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error: NameError: name 'bipartiteLayout' is not defined</code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-16-13.png" width="1152" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="do-it-yourself-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-4" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-4"></a>
</h3>
<div class="callout-content">
<p>Why did this happen, what check can you do to avoid the problem, and
how do you debug it?</p>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<p>In this instance, the error message is very clear: you can’t plot a
graph with a bipartite layout if the graph isn’t bipartite. This would
have also been evident if I hadn’t just checked that the graph was
connected, but also that it was bipartite.</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>nx.bipartite.is_bipartite(thisBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">False</span></span></code></pre>
</div>
<p>There is one edge connecting two nodes within one group. If we either
remove that edge, or change one of the nodes to the other group, it will
be bipartite.</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>thisBipartite <span class="op">=</span> nx.Graph()</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Add nodes with the node attribute "bipartite"</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>thisBipartite.add_nodes_from([<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span>], bipartite<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>thisBipartite.add_nodes_from([<span class="st">'m'</span>, <span class="st">'n'</span>, <span class="st">'o'</span>, <span class="st">'p'</span>, <span class="st">'q'</span>, <span class="st">'r'</span>], bipartite<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add edges only between nodes of opposite node sets</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>thisBipartite.add_edges_from([(<span class="st">'a'</span>, <span class="st">'m'</span>), (<span class="st">'a'</span>, <span class="st">'n'</span>),</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'b'</span>, <span class="st">'n'</span>), (<span class="st">'b'</span>, <span class="st">'o'</span>),</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'c'</span>, <span class="st">'o'</span>), (<span class="st">'d'</span>, <span class="st">'m'</span>),</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'a'</span>, <span class="st">'p'</span>), (<span class="st">'a'</span>, <span class="st">'n'</span>),</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'f'</span>, <span class="st">'p'</span>), (<span class="st">'d'</span>, <span class="st">'r'</span>),</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>                              (<span class="st">'a'</span>, <span class="st">'q'</span>), (<span class="st">'e'</span>, <span class="st">'n'</span>)])</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>nx.bipartite.is_bipartite(thisBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>basegroup <span class="op">=</span> nx.bipartite.sets(thisBipartite)[<span class="dv">0</span>]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>bipartiteLayout <span class="op">=</span> nx.bipartite_layout(thisBipartite, basegroup)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> nx.draw(thisBipartite, bipartiteLayout,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>              node_size<span class="op">=</span><span class="dv">2000</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>              node_color<span class="op">=</span><span class="st">'tomato'</span>,</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>              node_shape<span class="op">=</span><span class="st">'h'</span>,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>              with_labels<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-20-15.png" width="1152" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</div>
</section><section id="example-full-c.-elegans-neural-network"><h2 class="section-heading">Example: Full <em>C. elegans</em> Neural Network<a class="anchor" aria-label="anchor" href="#example-full-c.-elegans-neural-network"></a>
</h2>
<hr class="half-width">
<p>In the final part, we look at two publicly available networks that
are of biomedical interest.</p>
<p style="text-align: justify;">
In this first example we return to data about the neuronal connections
in <em>C. elegans</em>. This time we are using the full 277 neuron
dataset, which includes 131 frontal neurons. For the original version of
the data, go to the (<a href="https://www.dynamic-connectome.org/" class="external-link">Dynamic Connectome</a>)
website and select the Resources tab.
</p>
<p style="text-align: justify;">
The data in the <span class="math inline">\(277 \times 277\)</span>
network matrix in the celegans277.zip file contain the connections
between the 131 neurons in the frontal network, and 146 in the remainder
or the network. If the connections <em>within</em> each of these groups
are severed, and the only remaining edges are between the two groups,
this takes the form of a <em>bipartite graph</em>.
</p>
<p style="text-align: justify;">
We have made available this modified version of the 277 neuron matrix,
with no edges within the 131 or the 146 neuron group, see file
‘celegans277matrix_bipartite.csv’. Note that bipartite networks do not
work in NetworkX if any of the nodes are not connected. Also available
for download is a list of neuron labels and spatial positions, files
‘celegans277labels.csv’ and ‘celegans277positions.csv’.
</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>neurons <span class="op">=</span> read_csv(<span class="st">'data/celegans277matrix_bipartite.csv'</span>, header<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="st">"int"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>neuronNames <span class="op">=</span> read_csv(<span class="st">'data/celegans277labels.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>neurons<span class="op">=</span> neurons.to_numpy()</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>neuronNames<span class="op">=</span> neuronNames.to_dict()</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>myBipartiteLabels <span class="op">=</span> neuronNames[<span class="dv">0</span>]</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>myBipartite <span class="op">=</span> nx.from_numpy_matrix(neurons)</span></code></pre>
</div>
<p style="text-align: justify;">
Here we import the bipartite module from NetworkX, and then import the
bipartite 277 neuron adjacency matrix and list of neuron names, with the
same method as previously. Next, we use the bipartite convention in
NetworkX to designate which nodes are in the <span class="math inline">\(0\)</span> group, and which are in the <span class="math inline">\(1\)</span> group. There are several ways to make a
graph bipartite, here this is done by listing the node numbers of the
146 neurons and adding the attribute <span class="math inline">\('bipartite' = 0\)</span>, and listing the
node numbers of the 131 neurons and adding the attribute <span class="math inline">\('bipartite' = 1\)</span>.
</p>
<div class="codewrapper sourceCode" id="cb35">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>myBipartite.add_nodes_from([</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>,   <span class="dv">1</span>,   <span class="dv">2</span>,   <span class="dv">3</span>,  <span class="dv">13</span>,  <span class="dv">14</span>,  <span class="dv">17</span>,  <span class="dv">21</span>,  <span class="dv">22</span>,  <span class="dv">23</span>,  <span class="dv">24</span>,  <span class="dv">25</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a> <span class="dv">26</span>,  <span class="dv">27</span>,  <span class="dv">28</span>,  <span class="dv">29</span>,  <span class="dv">30</span>,  <span class="dv">31</span>,  <span class="dv">32</span>,  <span class="dv">33</span>,  <span class="dv">34</span>,  <span class="dv">35</span>,  <span class="dv">36</span>,  <span class="dv">59</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a> <span class="dv">60</span>,  <span class="dv">61</span>,  <span class="dv">66</span>,  <span class="dv">67</span>,  <span class="dv">69</span>,  <span class="dv">78</span>,  <span class="dv">79</span>,  <span class="dv">84</span>,  <span class="dv">85</span>,  <span class="dv">86</span>,  <span class="dv">87</span>,  <span class="dv">88</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a> <span class="dv">89</span>,  <span class="dv">90</span>,  <span class="dv">91</span>,  <span class="dv">92</span>,  <span class="dv">93</span>,  <span class="dv">94</span>,  <span class="dv">95</span>,  <span class="dv">96</span>,  <span class="dv">97</span>,  <span class="dv">98</span>,  <span class="dv">99</span>, <span class="dv">100</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="dv">101</span>, <span class="dv">102</span>, <span class="dv">103</span>, <span class="dv">104</span>, <span class="dv">105</span>, <span class="dv">106</span>, <span class="dv">107</span>, <span class="dv">108</span>, <span class="dv">109</span>, <span class="dv">110</span>, <span class="dv">111</span>, <span class="dv">112</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="dv">125</span>, <span class="dv">126</span>, <span class="dv">133</span>, <span class="dv">134</span>, <span class="dv">135</span>, <span class="dv">136</span>, <span class="dv">137</span>, <span class="dv">138</span>, <span class="dv">139</span>, <span class="dv">140</span>, <span class="dv">141</span>, <span class="dv">142</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="dv">143</span>, <span class="dv">144</span>, <span class="dv">145</span>, <span class="dv">146</span>, <span class="dv">147</span>, <span class="dv">148</span>, <span class="dv">149</span>, <span class="dv">150</span>, <span class="dv">151</span>, <span class="dv">152</span>, <span class="dv">153</span>, <span class="dv">154</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="dv">155</span>, <span class="dv">156</span>, <span class="dv">157</span>, <span class="dv">158</span>, <span class="dv">159</span>, <span class="dv">160</span>, <span class="dv">161</span>, <span class="dv">162</span>, <span class="dv">170</span>, <span class="dv">171</span>, <span class="dv">172</span>, <span class="dv">173</span>,</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="dv">180</span>, <span class="dv">195</span>, <span class="dv">196</span>, <span class="dv">203</span>, <span class="dv">204</span>, <span class="dv">205</span>, <span class="dv">206</span>, <span class="dv">207</span>, <span class="dv">235</span>, <span class="dv">236</span>, <span class="dv">237</span>, <span class="dv">238</span>,</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="dv">239</span>, <span class="dv">240</span>, <span class="dv">241</span>, <span class="dv">242</span>, <span class="dv">243</span>, <span class="dv">244</span>, <span class="dv">245</span>, <span class="dv">246</span>, <span class="dv">247</span>, <span class="dv">248</span>, <span class="dv">249</span>, <span class="dv">250</span>,</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="dv">251</span>, <span class="dv">252</span>, <span class="dv">253</span>, <span class="dv">254</span>, <span class="dv">255</span>, <span class="dv">256</span>, <span class="dv">257</span>, <span class="dv">258</span>, <span class="dv">259</span>, <span class="dv">260</span>, <span class="dv">261</span>, <span class="dv">262</span>,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="dv">263</span>, <span class="dv">264</span>, <span class="dv">265</span>, <span class="dv">266</span>, <span class="dv">267</span>, <span class="dv">268</span>, <span class="dv">269</span>, <span class="dv">270</span>, <span class="dv">271</span>, <span class="dv">272</span>, <span class="dv">273</span>, <span class="dv">274</span>,</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="dv">275</span>, <span class="dv">276</span>], bipartite<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>myBipartite.add_nodes_from([</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">4</span>,   <span class="dv">5</span>,   <span class="dv">6</span>,   <span class="dv">7</span>,   <span class="dv">8</span>,   <span class="dv">9</span>,  <span class="dv">10</span>,  <span class="dv">11</span>,  <span class="dv">12</span>,  <span class="dv">15</span>,  <span class="dv">16</span>,</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a> <span class="dv">18</span>,  <span class="dv">19</span>,  <span class="dv">20</span>,  <span class="dv">37</span>,  <span class="dv">38</span>,  <span class="dv">39</span>,  <span class="dv">40</span>,  <span class="dv">41</span>,  <span class="dv">42</span>,  <span class="dv">43</span>,  <span class="dv">44</span>,</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a> <span class="dv">45</span>,  <span class="dv">46</span>,  <span class="dv">47</span>,  <span class="dv">48</span>,  <span class="dv">49</span>,  <span class="dv">50</span>,  <span class="dv">51</span>,  <span class="dv">52</span>,  <span class="dv">53</span>,  <span class="dv">54</span>,  <span class="dv">55</span>,</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a> <span class="dv">56</span>,  <span class="dv">57</span>,  <span class="dv">58</span>,  <span class="dv">62</span>,  <span class="dv">63</span>,  <span class="dv">64</span>,  <span class="dv">65</span>,  <span class="dv">68</span>,  <span class="dv">70</span>,  <span class="dv">71</span>,  <span class="dv">72</span>,</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a> <span class="dv">73</span>,  <span class="dv">74</span>,  <span class="dv">75</span>,  <span class="dv">76</span>,  <span class="dv">77</span>,  <span class="dv">80</span>,  <span class="dv">81</span>,  <span class="dv">82</span>,  <span class="dv">83</span>, <span class="dv">113</span>, <span class="dv">114</span>,</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="dv">115</span>, <span class="dv">116</span>, <span class="dv">117</span>, <span class="dv">118</span>, <span class="dv">119</span>, <span class="dv">120</span>, <span class="dv">121</span>, <span class="dv">122</span>, <span class="dv">123</span>, <span class="dv">124</span>, <span class="dv">127</span>,</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">130</span>, <span class="dv">131</span>, <span class="dv">132</span>, <span class="dv">163</span>, <span class="dv">164</span>, <span class="dv">165</span>, <span class="dv">166</span>, <span class="dv">167</span>, <span class="dv">168</span>,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="dv">169</span>, <span class="dv">174</span>, <span class="dv">175</span>, <span class="dv">176</span>, <span class="dv">177</span>, <span class="dv">178</span>, <span class="dv">179</span>, <span class="dv">181</span>, <span class="dv">182</span>, <span class="dv">183</span>, <span class="dv">184</span>,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="dv">185</span>, <span class="dv">186</span>, <span class="dv">187</span>, <span class="dv">188</span>, <span class="dv">189</span>, <span class="dv">190</span>, <span class="dv">191</span>, <span class="dv">192</span>, <span class="dv">193</span>, <span class="dv">194</span>, <span class="dv">197</span>,</span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="dv">198</span>, <span class="dv">199</span>, <span class="dv">200</span>, <span class="dv">201</span>, <span class="dv">202</span>, <span class="dv">208</span>, <span class="dv">209</span>, <span class="dv">210</span>, <span class="dv">211</span>, <span class="dv">212</span>, <span class="dv">213</span>,</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="dv">214</span>, <span class="dv">215</span>, <span class="dv">216</span>, <span class="dv">217</span>, <span class="dv">218</span>, <span class="dv">219</span>, <span class="dv">220</span>, <span class="dv">221</span>, <span class="dv">222</span>, <span class="dv">223</span>, <span class="dv">224</span>,</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="dv">225</span>, <span class="dv">226</span>, <span class="dv">227</span>, <span class="dv">228</span>, <span class="dv">229</span>, <span class="dv">230</span>, <span class="dv">231</span>, <span class="dv">232</span>, <span class="dv">233</span>, <span class="dv">234</span>], bipartite<span class="op">=</span><span class="dv">1</span>)</span></code></pre>
</div>
<p>We can confirm that the network is bipartite.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>nx.bipartite.is_bipartite(myBipartite)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<p>Next, we continue to use the bipartite convention introduced above to
define the two bipartite groups, and set up a custom colouring list by
group.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>top <span class="op">=</span> nx.bipartite.sets(myBipartite)[<span class="dv">0</span>]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>pos <span class="op">=</span> nx.bipartite_layout(myBipartite, top)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>color_dictionary <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'gold'</span>,<span class="dv">1</span>:<span class="st">'lavender'</span>}</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>color_list <span class="op">=</span> [color_dictionary[i[<span class="dv">1</span>]] <span class="cf">for</span> i <span class="kw">in</span> myBipartite.nodes.data(<span class="st">'bipartite'</span>)]</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">30</span>))</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>nx.draw(myBipartite, pos,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">1200</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>myBipartiteLabels,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span>color_list)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-24-17.png" width="960" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>The graph shows in a preliminary way that there are certain preferred
connections between the two sets, in this case between the frontal group
and the rest of the neurons.</p>
<div id="do-it-yourself-5" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="do-it-yourself-5" class="callout-inner">
<h3 class="callout-title">Do it Yourself<a class="anchor" aria-label="anchor" href="#do-it-yourself-5"></a>
</h3>
<div class="callout-content">
<p>Draw the bipartite neural network, coloured by group and positioned
using the positional information from Dynamic Connectome in the file
‘celegans277positions.csv’.</p>
</div>
</div>
</div>
<div id="accordionSolution6" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution6" aria-expanded="false" aria-controls="collapseSolution6">
  <h4 class="accordion-header" id="headingSolution6">
  DIY ANSWER
  </h4>
</button>
<div id="collapseSolution6" class="accordion-collapse collapse" aria-labelledby="headingSolution6" data-bs-parent="#accordionSolution6">
<div class="accordion-body">
<p>The 2D positions are contained in the file
‘celegans277positions.csv’. After the import of the file, they can be
extracted into a variable using <code>values</code>. The positions then
need to replace the original layout values (called ‘pos’ above).</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>neuronPos <span class="op">=</span> read_csv(<span class="st">'data/celegans277positions.csv'</span>, header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>neuronPositions <span class="op">=</span> neuronPos.values</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">20</span>))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>nx.draw(myBipartite, neuronPositions,</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>myBipartiteLabels,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span>color_list)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-25-19.png" width="960" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="example-microbiome-network"><h2 class="section-heading">Example: Microbiome network<a class="anchor" aria-label="anchor" href="#example-microbiome-network"></a>
</h2>
<hr class="half-width">
<p style="text-align: justify;">
Microbiome data can be collected from a wide variety of environments,
and is generally considered to be the bacterial, fungal, and viral
components of a given environment. <a href="https://doi.org/10.1371/journal.pcbi.1002687" class="external-link">Friedman and Alm
(2012)</a> used data from the <a href="https://www.nature.com/articles/nature11209" class="external-link">Human Microbiome
Project</a> to calculate pairwise interaction correlations for each
operational taxonomic unit (OTU). They then used Python and NetworkX to
analyse and visualise several of these correlation datasets for each
human body site. The challenge here is to extract network information
about a graph from bivariate quantities like the correlation
coefficient.
</p>
<img src="../fig/microbiomenetworks.png" class="figure"> As the correlation data are
open access, we can access them and derive the network.
<p style="text-align: justify;">
Data are imported from text files. In this case, it is not a CSV file.
Rather, the data are tab separated. We can adjust for this by specifying
the keyword argument <code>delimiter</code> for tab. As the correlation
coefficients are stored as decimal point numbers, we specify the keyword
argument <code>dtype</code> as floating point ‘float64’.
</p>
<p style="text-align: justify;">
If you check the file, you will see that the first entry is ‘1.0’. This
is because all self-correlations are (trivially) equal to one. We
replace those diagonal values with 0 to avoid (nonsensical)
self-connections in the network.
</p>
<div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>gutbact      <span class="op">=</span> read_csv(<span class="st">'data/Stool_sparse_adj_matrix.txt'</span>,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>                        header<span class="op">=</span><span class="va">None</span>, delimiter<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, dtype<span class="op">=</span><span class="st">"float64"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>gutbactNames <span class="op">=</span> read_csv(<span class="st">'data/Stool_sparse_matrix_names.txt'</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                        header<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>gutbact<span class="op">=</span> gutbact.to_numpy()</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>fill_diagonal(gutbact, <span class="dv">0</span>)</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>gutbactNames<span class="op">=</span> gutbactNames.to_dict()</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>gutbactLabels <span class="op">=</span> gutbactNames[<span class="dv">0</span>]</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>gutbactGraph <span class="op">=</span> nx.from_numpy_matrix(gutbact)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>gutbactLayout <span class="op">=</span> nx.circular_layout(gutbactGraph)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">16</span>))</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>nx.draw(gutbactGraph, gutbactLayout,</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'r'</span>,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>gutbactLabels)</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-27-21.png" width="1536" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This gives us the correlation network from the stool samples, with nodes
labelled by the OTU number. However, this doesn’t look much like the
data from the article, partly as there are so many edges. The reason is
that any number in the network matrix that is not equal to zero is
interpreted as an edge. Thus, essentially the graph is fully connected.
</p>
<div class="section level3">
<h3 id="functional-networks">
<strong>Functional Networks</strong><a class="anchor" aria-label="anchor" href="#functional-networks"></a>
</h3>
<p style="text-align: justify;">
In the paper, Friedman and Alm (2012), the edges are taken from the
correlation coefficients of the correlation matrix. I.e. they define the
correlation matrix as a network matrix. But the entries of the
correlation matrix are not 0s and 1s as we have used so far. Instead
they are real numbers between -1 and 1. What Friedman and Alm did to
obtain meaningful edges was to pick a threshold correlation, e.g. <span class="math inline">\(|cc| = 0.3\)</span> and set any matrix entry with
absolute value smaller than the threshold as 0. All other values are
left as they are. Because anything non-zero will be interpreted as an
edge, this means that they only plot edges where the correlation
coefficient is greater than 0.3 or less than -0.3. Such networks are
referred to as <em>functional networks</em>.
</p>
<p style="text-align: justify;">
To threshold the correlation matrix in Python, we select matrix values
between -0.3 and 0.3, and replace them with 0. Then we convert this
thresholded network matrix to a graph and plot it.
</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> where, logical_and</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>threshold <span class="op">=</span> <span class="fl">0.3</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>gutbact_threshold <span class="op">=</span> where(logical_and(gutbact<span class="op">&gt;=-</span>threshold , gutbact<span class="op">&lt;=</span>threshold), <span class="dv">0</span>, gutbact)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>gutbactGraph <span class="op">=</span> nx.from_numpy_matrix(gutbact_threshold)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> subplots(figsize<span class="op">=</span>(<span class="dv">16</span>,<span class="dv">16</span>))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>nx.draw(gutbactGraph, gutbactLayout,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>        node_size<span class="op">=</span><span class="dv">3000</span>,</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>        node_color<span class="op">=</span><span class="st">'r'</span>,</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>        labels<span class="op">=</span>gutbactLabels)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>show()</span></code></pre>
</div>
<figure><img src="../fig/03-networks_3-rendered-unnamed-chunk-29-23.png" width="1536" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p style="text-align: justify;">
This network only displays edges where strong correlations were found
and this is how Friedman and Alm obtained their graphs. Note that the
network structure now is a function of the chosen threshold. Smaller
thresholds yield more edges, higher thresholds fewer edges. Choosing the
right threshold may be difficult and needs further thought.
</p>
<p style="text-align: justify;">
The creation of networks from functional data opens a wide field of
research: <em>any</em> interrelation matrix obtained with whatever
metric can be interpreted as a network matrix and converted into a
graph. As an example, see Figure 1 in <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3621511/" class="external-link">The Brain
as a Complex System: Using Network Science as a Tool for Understanding
the Brain</a> which describes the procedure for brain imaging.
</p>
<p style="text-align: justify;">
This concludes our set of Lessons on network handling in Python. For
practice, try to find a database that touches on topics of your own
interest. As an example, in the context of the human brain, there is a
rich database at the <a href="http://www.humanconnectomeproject.org/data/" class="external-link">Human Connectome
Database</a>. Each database will present its own challenges and
obstacles. Nevertheless, it is worth to overcome those to be able to
work with the data in Python. Eventually, all functions and dysfunctions
observed in living systems are a consequence of interactions between
components.
</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Keypoints<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>
<code>.csv</code> is a common file format when importing network
data.</li>
<li>
<code>JSON</code> is another widely used standard file format which
is language independent.</li>
<li>
<code>FileNotFoundError</code>, <code>KeyError</code> and
<code>Graph is not bipartite</code> are the most common file import
errors.</li>
</ul>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
				<p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/LearnToDiscover/Networks.git/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/LearnToDiscover/Networks.git/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a> 
        | <a href="https://github.com/LearnToDiscover/Networks.git/" class="external-link">Source</a></p>
				<p><a href="https://github.com/LearnToDiscover/Networks.git/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="../LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">Template licensed under CC-BY 4.0</a> by <a href="https://carpentries.org" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/LearnToDiscover/sandpaper/tree/l2d" class="external-link">sandpaper (0.12.5)</a>,
        <a href="https://github.com/carpentries/pegboard/tree/dbc40280b29c85d25654735767c682e2f64f28a5" class="external-link">pegboard (0.5.3)</a>,
      and <a href="https://github.com/LearnToDiscover/varnish/tree/4530696c50ae9f1049b7e1d5f1216d40b02403d9" class="external-link">varnish (0.2.14)</a>.</p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
			<i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back to top"></i><br><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://learntodiscover.github.io/Networks/instructor/aio.html",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://learntodiscover.github.io/Networks/instructor/aio.html",
  "identifier": "https://learntodiscover.github.io/Networks/instructor/aio.html",
  "dateCreated": "2023-06-21",
  "dateModified": "2023-08-01",
  "datePublished": "2023-08-01"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

